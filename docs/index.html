<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Qingqing Pang">

<title>Macroeconometrics Research Report - Exchange Rate Forecasting Using Bayesian VARs Model</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Macroeconometrics Research Report</span>
    </a>
  </div>
        <div class="quarto-navbar-tools ms-auto">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#objective-and-motivation" id="toc-objective-and-motivation" class="nav-link active" data-scroll-target="#objective-and-motivation">Objective and Motivation</a></li>
  <li><a href="#data-and-variables" id="toc-data-and-variables" class="nav-link" data-scroll-target="#data-and-variables">Data and Variables</a>
  <ul class="collapse">
  <li><a href="#data-cleaning" id="toc-data-cleaning" class="nav-link" data-scroll-target="#data-cleaning">Data Cleaning</a></li>
  </ul></li>
  <li><a href="#model-and-hypotheses" id="toc-model-and-hypotheses" class="nav-link" data-scroll-target="#model-and-hypotheses">Model and Hypotheses</a></li>
  <li><a href="#modelling-framework" id="toc-modelling-framework" class="nav-link" data-scroll-target="#modelling-framework">Modelling Framework</a>
  <ul class="collapse">
  <li><a href="#the-basic-model" id="toc-the-basic-model" class="nav-link" data-scroll-target="#the-basic-model">The basic model</a>
  <ul class="collapse">
  <li><a href="#estimation-outcomes-on-basic-model" id="toc-estimation-outcomes-on-basic-model" class="nav-link" data-scroll-target="#estimation-outcomes-on-basic-model">Estimation Outcomes on Basic Model</a></li>
  </ul></li>
  <li><a href="#the-extended-model" id="toc-the-extended-model" class="nav-link" data-scroll-target="#the-extended-model">The Extended Model</a>
  <ul class="collapse">
  <li><a href="#estimation-outcomes-on-extended-model" id="toc-estimation-outcomes-on-extended-model" class="nav-link" data-scroll-target="#estimation-outcomes-on-extended-model">Estimation Outcomes on Extended Model</a></li>
  </ul></li>
  <li><a href="#the-basic-model-with-stochastic-volatility-heteroskedasticity" id="toc-the-basic-model-with-stochastic-volatility-heteroskedasticity" class="nav-link" data-scroll-target="#the-basic-model-with-stochastic-volatility-heteroskedasticity">The Basic Model With Stochastic Volatility Heteroskedasticity</a>
  <ul class="collapse">
  <li><a href="#estimation-outcomes-on-basic-stochastic-volatility-model" id="toc-estimation-outcomes-on-basic-stochastic-volatility-model" class="nav-link" data-scroll-target="#estimation-outcomes-on-basic-stochastic-volatility-model">Estimation Outcomes on Basic Stochastic Volatility Model</a></li>
  </ul></li>
  <li><a href="#the-extension-model-with-stochastic-volatility-heteroskedasticity" id="toc-the-extension-model-with-stochastic-volatility-heteroskedasticity" class="nav-link" data-scroll-target="#the-extension-model-with-stochastic-volatility-heteroskedasticity">The Extension Model With Stochastic Volatility Heteroskedasticity</a></li>
  <li><a href="#proof-of-model-validity" id="toc-proof-of-model-validity" class="nav-link" data-scroll-target="#proof-of-model-validity">Proof of Model Validity</a>
  <ul class="collapse">
  <li><a href="#proof-of-basic-model-validity" id="toc-proof-of-basic-model-validity" class="nav-link" data-scroll-target="#proof-of-basic-model-validity">Proof of Basic Model Validity</a></li>
  <li><a href="#proof-of-extended-model" id="toc-proof-of-extended-model" class="nav-link" data-scroll-target="#proof-of-extended-model">Proof of Extended Model</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#forecasting" id="toc-forecasting" class="nav-link" data-scroll-target="#forecasting">Forecasting</a>
  <ul class="collapse">
  <li><a href="#forecasting-with-models" id="toc-forecasting-with-models" class="nav-link" data-scroll-target="#forecasting-with-models">Forecasting With Models</a>
  <ul class="collapse">
  <li><a href="#forecasting-with-basic-model" id="toc-forecasting-with-basic-model" class="nav-link" data-scroll-target="#forecasting-with-basic-model">Forecasting With Basic Model</a></li>
  <li><a href="#forecasting-on-extended-model" id="toc-forecasting-on-extended-model" class="nav-link" data-scroll-target="#forecasting-on-extended-model">Forecasting on Extended Model</a></li>
  <li><a href="#forecasting-on-basic-model-with-stochastic-volatility-heteroskedasticity" id="toc-forecasting-on-basic-model-with-stochastic-volatility-heteroskedasticity" class="nav-link" data-scroll-target="#forecasting-on-basic-model-with-stochastic-volatility-heteroskedasticity">Forecasting on Basic Model With Stochastic Volatility Heteroskedasticity</a></li>
  <li><a href="#interactive-3d-versions" id="toc-interactive-3d-versions" class="nav-link" data-scroll-target="#interactive-3d-versions">Interactive 3D versions</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Exchange Rate Forecasting Using Bayesian VARs Model</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Qingqing Pang </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<blockquote class="blockquote">
<p><strong>Abstract.</strong> This research report explores how Bayesian VARs model predict AUD/USD exchange rate. <strong>Keywords.</strong> Bayesian Vars, Exchange rate, Forecasting, Minnesota Prior, Laplace distribution</p>
</blockquote>
<section id="objective-and-motivation" class="level1">
<h1>Objective and Motivation</h1>
<p>The objective of this research is to use the Bayesian Vector Autoregressions (VARs) method to forecast the exchange rate of the US dollar exchange rate against the Australian dollar.</p>
<p>The ability to accurately forecast the foreign exchange rate is crucial for Australia’s global trade and investment. Given the prominence of the US dollar as the world’s primary reserve currency, the monetary policies of the US Federal Reserve have a worldwide effect on the world economy, its significant influence on the Australia currency market should be important for domestic investors and policy maker as it can directly impact the AUD/USD exchange rate. Besides, America as one of the major trading partners for Australia, can impact bilateral trade flows and eventually affect the value of the AUD. Apart from the external from foreign countries, the domestic economic indicators can also be one of the determinants of the AUD/USD exchange rate.</p>
<p>The research is aimed to address the question for example, how the AUD/USD exchange rate will be in 3 months or even longer 1 year?</p>
</section>
<section id="data-and-variables" class="level1">
<h1>Data and Variables</h1>
<p>To better forecast the change in the exchange rate, the 13 variables are selected as follows which contain both domestic and US economic indicators that affect the exchange rate in different ways.</p>
<p>Real GDP and interest rates have a significant effect on the exchange rate, a higher realGDP and interest rate in Australia may increase the demand for AUD, which will lead to an appreciation of AUD and a rise in the AUD/USD exchange rate. A higher CPI indicates a lower purchasing power relative to foreign currency which may lead to a depreciation of the domestic currency. The unemployment rate can in some way represent business activity and a country with a high unemployment rate will lower the attractiveness for foreign investors and weaken the domestic currency competitiveness in the currency market. The balance of trade, which is the difference between exports and imports, also can influence the demand for its currency, a trade surplus in AUD may increase the demand for AUD dollar.</p>
<ul>
<li><p><span class="math inline">\(erate_{t}\)</span>: AUD/USD exchange rate</p></li>
<li><p>AUS economic indicators</p>
<ul>
<li><span class="math inline">\(crate\_au_{t}\)</span>: The Cash Rate Target, Australia</li>
<li><span class="math inline">\(rgdp\_au_{t}\)</span>: The Real Gross Domestic Product, Australia</li>
<li><span class="math inline">\(cpi\_au_{t}\)</span>: The Consumer Price Index, Australia</li>
<li><span class="math inline">\(unemr\_au_{t}\)</span>: The Unemployment rate, Australia</li>
<li><span class="math inline">\(impor\_au_{t}\)</span>: The Imports of Goods and Services, Australia</li>
<li><span class="math inline">\(expor\_au_{t}\)</span>: The Exports of Goods and Services, Australia</li>
</ul></li>
<li><p>US economic indicators</p>
<ul>
<li><span class="math inline">\(crate\_us_{t}\)</span>: The Federal Funds Effective Rate, United States</li>
<li><span class="math inline">\(rgdp\_us_{t}\)</span>: The Real Gross Domestic Product, United States</li>
<li><span class="math inline">\(cpi\_us_{t}\)</span>: The Consumer Price Index, United States</li>
<li><span class="math inline">\(unemr\_us_{t}\)</span>: The Unemployment rate, United States</li>
<li><span class="math inline">\(impor\_us_{t}\)</span>: The Imports of Goods and Services, United States</li>
<li><span class="math inline">\(expor\_us_{t}\)</span>: The Exports of Goods and Services, United States</li>
</ul></li>
</ul>
<section id="data-cleaning" class="level3">
<h3 class="anchored" data-anchor-id="data-cleaning">Data Cleaning</h3>
<p>For the data cleaning part, most data for AUS is from Reserve Bank of Australia (RBA) and Australian Bureau of Statistics (ABS), and data for the US is from FRED, the dataset spans from 1990 Q1 to 2023 Q4, comprising 136 observations. To better fit the model, the data has been transformed to ‘quarter’ to ensure that seasonality effects are removed and logged transformations have been applied to most data except exchange rate and cash rate to reducing outlier effects.</p>
<section id="visualisation-of-data" class="level4">
<h4 class="anchored" data-anchor-id="visualisation-of-data">Visualisation of data</h4>
<p>Plot the variables to see the patterns of data. It shows from the plots that the exchange rate and cash rate for the US fluctuate over time, the cash rate and unemployment for AU show a downward trend and all other variables have a clear upward trend, with the exports、imports, and GDP for both countries have a clear drop during the COVID-19 period.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/all variables plot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Since most variables show a non-stationary pattern. To determine whether a unit root is present in a time series dataset, the ADF test will be conducted below.</p>
</section>
<section id="augmented-dickey-fuller-test-for-log-transformed-variables-except-exchange-rates-and-cash-rates." class="level4">
<h4 class="anchored" data-anchor-id="augmented-dickey-fuller-test-for-log-transformed-variables-except-exchange-rates-and-cash-rates.">Augmented Dickey-Fuller test for log transformed variables except exchange rates and cash rates.</h4>
<p>From the plot we can observe all ACF plots have a high degree of persistence over time, indicating there is significant autocorrelation in the time series data.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Below is the p-value of each variable and only the cash rate for AUS has a p-value less than 0.05 which indicates that <span class="math inline">\(crateau_{t}\)</span> is stationary.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">P-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">exchange rate</td>
<td style="text-align: right;">0.671</td>
</tr>
<tr class="even">
<td style="text-align: left;">cpi_au</td>
<td style="text-align: right;">0.214</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cpi_us</td>
<td style="text-align: right;">0.410</td>
</tr>
<tr class="even">
<td style="text-align: left;">cashrate_au</td>
<td style="text-align: right;">0.010</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cashrate_us</td>
<td style="text-align: right;">0.047</td>
</tr>
<tr class="even">
<td style="text-align: left;">export_au</td>
<td style="text-align: right;">0.431</td>
</tr>
<tr class="odd">
<td style="text-align: left;">export_us</td>
<td style="text-align: right;">0.365</td>
</tr>
<tr class="even">
<td style="text-align: left;">import_au</td>
<td style="text-align: right;">0.095</td>
</tr>
<tr class="odd">
<td style="text-align: left;">import_us</td>
<td style="text-align: right;">0.603</td>
</tr>
<tr class="even">
<td style="text-align: left;">realgdp_au</td>
<td style="text-align: right;">0.961</td>
</tr>
<tr class="odd">
<td style="text-align: left;">realgdp_us</td>
<td style="text-align: right;">0.633</td>
</tr>
<tr class="even">
<td style="text-align: left;">unemployemtrate_au</td>
<td style="text-align: right;">0.419</td>
</tr>
<tr class="odd">
<td style="text-align: left;">unemployemtrate_us</td>
<td style="text-align: right;">0.328</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Below is the ADF test result for all non-stationary data taking the first difference. All variables in the first differences are stationary as the null hypothesis of non-stationary can be rejected.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">P-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">exchange rate</td>
<td style="text-align: right;">0.010</td>
</tr>
<tr class="even">
<td style="text-align: left;">cpi_au</td>
<td style="text-align: right;">0.027</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cpi_us</td>
<td style="text-align: right;">0.012</td>
</tr>
<tr class="even">
<td style="text-align: left;">cashrate_us</td>
<td style="text-align: right;">0.012</td>
</tr>
<tr class="odd">
<td style="text-align: left;">export_au</td>
<td style="text-align: right;">0.010</td>
</tr>
<tr class="even">
<td style="text-align: left;">export_us</td>
<td style="text-align: right;">0.010</td>
</tr>
<tr class="odd">
<td style="text-align: left;">import_au</td>
<td style="text-align: right;">0.010</td>
</tr>
<tr class="even">
<td style="text-align: left;">import_us</td>
<td style="text-align: right;">0.010</td>
</tr>
<tr class="odd">
<td style="text-align: left;">realgdp_au</td>
<td style="text-align: right;">0.010</td>
</tr>
<tr class="even">
<td style="text-align: left;">realgdp_us</td>
<td style="text-align: right;">0.010</td>
</tr>
<tr class="odd">
<td style="text-align: left;">unemployemtrate_au</td>
<td style="text-align: right;">0.010</td>
</tr>
<tr class="even">
<td style="text-align: left;">unemployemtrate_us</td>
<td style="text-align: right;">0.010</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>It can be concluded that all variables are integrated at 1 at the 5% significance level of the ADF test, with the conclusion folding for <span class="math inline">\(crate\_au_{t}\)</span> only at 1% significance level. Appropriate prior distributions will be used to accommodate this fact for the VAR model.</p>
</section>
</section>
</section>
<section id="model-and-hypotheses" class="level1">
<h1>Model and Hypotheses</h1>
<p>In this research, the VAR(p) model will be applied to forecast the AUD/USD exchange rate, below is the basic model that is used in this research.</p>
<section id="the-basic-varp-model" class="level4">
<h4 class="anchored" data-anchor-id="the-basic-varp-model">The basic VAR(p) model</h4>
<span class="math display">\[\begin{aligned}
y_{t}=\mu_{0}+A_{1}y_{t-1}+\cdots+A_{p}y_{t-p}+\epsilon_{t} \\
\epsilon_{t}|Y_{t-1} \sim iid\mathcal{N}(0_{13},\Sigma)
\end{aligned}\]</span>
<p>For time <span class="math inline">\(t\)</span> = 1,2,…..,<span class="math inline">\(T\)</span>：</p>
<ul>
<li><span class="math inline">\(y_t\)</span> is a <span class="math inline">\(N(13)\times 1\)</span> vector of observations at time <span class="math inline">\(t\)</span></li>
<li><span class="math inline">\(\mu_0\)</span> is a <span class="math inline">\(N(13)\times 1\)</span> vector of constant terms</li>
<li><span class="math inline">\(A_i\)</span> is a <span class="math inline">\(N(13)\times N(13)\)</span> matrix of autoregressive slope parameters</li>
<li><span class="math inline">\(\epsilon_t\)</span> is a <span class="math inline">\(N(13)\times 1\)</span> vector of error terms and follows a multivariate white noise process</li>
<li><span class="math inline">\(Y_{t-1}\)</span> is the information set collecting observations on y up to time <span class="math inline">\(t-1\)</span></li>
<li><span class="math inline">\(\Sigma\)</span> is a <span class="math inline">\(N(13)\times N(13)\)</span> covariance matrix of the error term</li>
</ul>
<span class="math display">\[\begin{aligned}
y_{t}=\begin{pmatrix}
erate_{t}\\
crate\_au_{t} \\
rgdp\_au_{t}\\
cpi\_au_{t} \\
unemr\_au_{t}\\
impor\_au_{t} \\
expor\_au_{t} \\
crate\_us_{t} \\
rgdp\_us_{t} \\
cpi\_us_{t} \\
unemr\_us_{t} \\
impor\_us_{t}\\
expor\_us_{t}\\

\end{pmatrix}

\end{aligned}\]</span>
<p>For further research, we may use the predictive density function like 3-year-ahead forecast and forecast with Bayesian VARS.</p>
</section>
</section>
<section id="modelling-framework" class="level1">
<h1>Modelling Framework</h1>
<section id="the-basic-model" class="level2">
<h2 class="anchored" data-anchor-id="the-basic-model">The basic model</h2>
<span class="math display">\[\begin{align}
Y &amp;=XA+U\\
U|X&amp;\sim \mathcal{MN}_{T\times N}(0, \Sigma, I_T)\\
Y|X,A,\Sigma&amp;\sim \mathcal{MN}_{T\times N} (XA, \Sigma, I_T)
\end{align}\]</span>
<p>Where <span class="math inline">\(Y\)</span> is a <span class="math inline">\(T\times 13\)</span> Matrix, <span class="math inline">\(X\)</span> is a <span class="math inline">\(T\times(1+p\times13)\)</span>, <span class="math inline">\(A\)</span> is a <span class="math inline">\((1+p\times13)\times13\)</span> matrix that contains <span class="math inline">\(\mu_{0}\)</span> and vectors of the autoregressive slope parameters and <span class="math inline">\(U\)</span> is a <span class="math inline">\(T\times13\)</span> matrix contains vetors of error terms.</p>
<p>The kernel of the likelihood function:</p>
<span class="math display">\[\begin{align}
L(A,\Sigma|Y,X) \propto det(\Sigma)^{-\frac{T}{2}}exp\{-\frac{1}{2}tr[\Sigma^{-1}(Y-XA)'(Y-XA)]\}
\end{align}\]</span>
<p>The basic model is based on <strong>Natural-conjugate prior distribution</strong>, where the <span class="math inline">\(A\)</span> follows a Matrix-variate Normal distribution and <span class="math inline">\(\Sigma\)</span> follows an Inverse Wishart distribution.</p>
<span class="math display">\[\begin{align}
p(A,\Sigma) &amp;= p(A|\Sigma)p(\Sigma) \\
A|\Sigma &amp;\sim \mathcal{MN}_{K \times N}(\underline{A},\Sigma,\underline{V}) \\
\Sigma &amp;\sim \mathcal{IW}_N(\underline{S},\underline{\nu})
\end{align}\]</span>
<p>The <strong>Minnesota prior</strong> is typically a good choice for specifying priors in BVAR model especially when the model involves many macroeconomic variables. It assumes the variables follow a random walk and it is suitable for unit root non-stationary variables such as in our case, variables are integrated at 1 at the 5% significance level of the ADF test, where:</p>
<span class="math display">\[\begin{align}
\underline{A} &amp;= \begin{bmatrix}0_{N \times 1} &amp; I_{N} &amp; 0_{N \times (p-1)N}\end{bmatrix}'\\

\underline{V} &amp;= diag( \begin{bmatrix} \kappa_2 &amp; \kappa_1(p^{-2}\otimes I_N') \end{bmatrix})

\end{align}\]</span>
<p>The prior mean <span class="math inline">\(\underline{A}\)</span> for the first lag of each variable (the identity matrix portion) is one, while all other coefficients including intercepts, are zeroes. For the column-specific prior covariance <span class="math inline">\(\underline{V}\)</span>, two shrinkage hyper-parameters <span class="math inline">\(\kappa_1\)</span> and <span class="math inline">\(\kappa_2\)</span> represent the overall shrinkage level for slopes and constant terms respectively.</p>
<p>For <strong>posterior distribution</strong>, the kernel of the posterior distribution takes the form of the product of the likelihood and the prior distributions.</p>
<span class="math display">\[\begin{align*}
p(A,\Sigma|Y,X) &amp;\propto L(A,\Sigma|Y,X)p(A,\Sigma) \\
&amp;= L(A,\Sigma|Y,X)p(A|\Sigma)p(\Sigma)
\end{align*}\]</span>
<span class="math display">\[\begin{align}
p(A,\Sigma|Y,X) &amp;\propto \det(\Sigma)^{-\frac{T}{2}} \\
&amp;\times exp\{-\frac{1}{2}tr[\Sigma^{-1}(Y-XA)'(Y-XA)]\} \\
&amp;\times \det(\Sigma)^{-\frac{N+K+\underline{v}+1}{2}} \\
&amp;\times exp\{-\frac{1}{2}tr[\Sigma^{-1}(A-\underline{A}) \underline{V}^{-1}(A-\underline{A})]\} \\
&amp;\times exp\{-\frac{1}{2}tr[\Sigma^{-1}\underline{S}]\}
\end{align}\]</span>
<p>The kernel can be represent as the normal-inverse Wishart distribution and we can get the following <strong>full conditional joint posterior distribution:</strong></p>
<span class="math display">\[\begin{align}
p(A|Y,X,\Sigma) &amp;= \mathcal{MN}_{K \times N}(\bar{A}, \Sigma, \bar{V}) \\
p(\Sigma|Y,X) &amp;= \mathcal{IW}_N(\bar{S},\bar{\nu}) \\
\\
\bar{V} &amp;= (X'X + \underline{V}^{-1})^{-1} \\
\bar{A} &amp;= \bar{V}(X'Y + \underline{V}^{-1}\underline{A}) \\
\bar{\nu} &amp;= T + \underline{\nu} \\
\bar{S} &amp;= \underline{S} + Y'Y + \underline{A}'\underline{V}^{-1}\underline{A} - \bar{A}'\bar{V}^{-1}\bar{A} \\

\end{align}\]</span>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Posterior sample draw</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>posterior.draws       <span class="ot">=</span> <span class="cf">function</span> (S, Y, X, A.prior, V.prior, S.prior, nu.prior){</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># normal-inverse Wishard posterior parameters</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    V.bar.inv         <span class="ot">=</span> <span class="fu">t</span>(X)<span class="sc">%*%</span>X <span class="sc">+</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(V.prior))</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    V.bar             <span class="ot">=</span> <span class="fu">solve</span>(V.bar.inv)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    A.bar             <span class="ot">=</span> V.bar<span class="sc">%*%</span>(<span class="fu">t</span>(X)<span class="sc">%*%</span>Y <span class="sc">+</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(V.prior))<span class="sc">%*%</span>A.prior)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    nu.bar            <span class="ot">=</span> <span class="fu">nrow</span>(Y) <span class="sc">+</span> nu.prior</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    S.bar             <span class="ot">=</span> S.prior <span class="sc">+</span> <span class="fu">t</span>(Y)<span class="sc">%*%</span>Y <span class="sc">+</span> <span class="fu">t</span>(A.prior)<span class="sc">%*%</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">diag</span>(V.prior))<span class="sc">%*%</span>A.prior <span class="sc">-</span> <span class="fu">t</span>(A.bar)<span class="sc">%*%</span>V.bar.inv<span class="sc">%*%</span>A.bar</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    S.bar.inv         <span class="ot">=</span> <span class="fu">solve</span>(S.bar)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># posterior draws </span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    Sigma.posterior   <span class="ot">=</span> <span class="fu">rWishart</span>(S, <span class="at">df=</span>nu.bar, <span class="at">Sigma=</span>S.bar.inv)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    Sigma.posterior   <span class="ot">=</span> <span class="fu">apply</span>(Sigma.posterior,<span class="dv">3</span>,solve)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    Sigma.posterior   <span class="ot">=</span> <span class="fu">array</span>(Sigma.posterior,<span class="fu">c</span>(N,N,S))</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    A.posterior       <span class="ot">=</span> <span class="fu">array</span>(<span class="fu">rnorm</span>(<span class="fu">prod</span>(<span class="fu">c</span>(<span class="fu">dim</span>(A.bar),S))),<span class="fu">c</span>(<span class="fu">dim</span>(A.bar),S))</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    L                 <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">chol</span>(V.bar))</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>S){</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>      A.posterior[,,s]<span class="ot">=</span> A.bar <span class="sc">+</span> L<span class="sc">%*%</span>A.posterior[,,s]<span class="sc">%*%</span><span class="fu">chol</span>(Sigma.posterior[,,s])</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    output            <span class="ot">=</span> <span class="fu">list</span>(<span class="at">A.posterior=</span>A.posterior, <span class="at">Sigma.posterior=</span>Sigma.posterior)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(output)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="estimation-outcomes-on-basic-model" class="level3">
<h3 class="anchored" data-anchor-id="estimation-outcomes-on-basic-model">Estimation Outcomes on Basic Model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">round</span>(<span class="fu">apply</span>(posterior.sample.draws<span class="sc">$</span>A.posterior, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, mean),<span class="dv">6</span>))         <span class="co"># posterior draw A</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
[1,] -0.000065  4.393479  4.379507  4.322870  3.109329  9.393156  7.134650
[2,]  0.999953  0.000242  0.000198  0.000952 -0.002938  0.000597  0.000801
[3,] -0.000018  0.001903  0.001728 -0.012052 -0.009131  0.004610  0.003761
[4,] -0.000009  0.001763  0.001617 -0.010546 -0.007539  0.004364  0.003498
[5,] -0.000032 -0.012197 -0.011085  0.165779  0.089862 -0.030050 -0.023661
[6,] -0.000232 -0.009516 -0.008072  0.097602  0.164954 -0.023272 -0.018085
          [,8]      [,9]     [,10]     [,11]     [,12]     [,13]
[1,]  9.350763  7.400268 12.776791  9.592615  6.399594  5.077620
[2,]  0.000637  0.000655  0.000270  0.000141 -0.001146  0.003952
[3,]  0.005268  0.003939  0.002342  0.001804 -0.010968 -0.001805
[4,]  0.004948  0.003739  0.002214  0.001725 -0.010982 -0.002467
[5,] -0.034266 -0.024120 -0.014915 -0.011523  0.047572  0.026204
[6,] -0.024277 -0.019804 -0.011412 -0.008103  0.045282 -0.062060</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">round</span>(<span class="fu">apply</span>(posterior.sample.draws<span class="sc">$</span>Sigma.posterior, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, mean),<span class="dv">6</span>))     <span class="co"># posterior draw sigma</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
[1,]  0.001744 -0.000222 -0.000203  0.003388 -0.003713 -0.001053 -0.001388
[2,] -0.000222  0.035843  0.032494 -0.221025 -0.173022  0.087174  0.070890
[3,] -0.000203  0.032494  0.029826 -0.197727 -0.144431  0.080192  0.064603
[4,]  0.003388 -0.221025 -0.197727  3.156893  1.824037 -0.535259 -0.425632
[5,] -0.003713 -0.173022 -0.144431  1.824037  3.454357 -0.426593 -0.331317
[6,] -0.001053  0.087174  0.080192 -0.535259 -0.426593  0.222599  0.177865
          [,8]      [,9]     [,10]     [,11]     [,12]     [,13]
[1,] -0.002123 -0.000869 -0.000223 -0.000162 -0.001155  0.011375
[2,]  0.099222  0.074344  0.044465  0.034232 -0.207662 -0.034843
[3,]  0.090888  0.068666  0.040791  0.031652 -0.199186 -0.039388
[4,] -0.623161 -0.423506 -0.268601 -0.205256  0.724093  0.333177
[5,] -0.441620 -0.362079 -0.209438 -0.148299  0.825929 -1.284683
[6,]  0.245494  0.192669  0.109971  0.085755 -0.589570 -0.104457</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(posterior.sample.draws<span class="sc">$</span>A.posterior[<span class="dv">1</span>,<span class="dv">1</span>,], <span class="at">xlab =</span> <span class="st">"Simulation times S"</span>, <span class="at">ylab =</span> <span class="st">"AUD/USD exchange rate"</span>, <span class="at">col =</span> mcxs1)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior.sample.draws<span class="sc">$</span>A.posterior[<span class="dv">1</span>,<span class="dv">1</span>,], <span class="at">xlab =</span> <span class="st">"AUD/USD exchange rate"</span>, <span class="at">col =</span> mcxs1, <span class="at">main =</span> <span class="st">''</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(posterior.sample.draws<span class="sc">$</span>Sigma.posterior[<span class="dv">1</span>,<span class="dv">1</span>,], <span class="at">xlab =</span> <span class="st">"Simulation times S"</span>, <span class="at">ylab =</span> <span class="st">"AUD/USD exchange rate sigma"</span>, <span class="at">col =</span> mcxs2)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior.sample.draws<span class="sc">$</span>Sigma.posterior[<span class="dv">1</span>,<span class="dv">1</span>,], <span class="at">xlab =</span> <span class="st">"AUD/USD exchange rate sigma"</span>, <span class="at">col =</span> mcxs2, <span class="at">main =</span> <span class="st">''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The trace plots and the histogram plot of posterior draws of<span class="math inline">\(A\)</span> and <span class="math inline">\(\Sigma\)</span> is presented above with the trace plots shows significant volatility.</p>
</section>
</section>
<section id="the-extended-model" class="level2">
<h2 class="anchored" data-anchor-id="the-extended-model">The Extended Model</h2>
<p>The extended model will be built based on the the change in distribution of the error to <strong>Laplace distribution</strong> instead of the normally distributed errors assumption. The Laplace distribution is suitable for describing financial anomalies due to its sharp peaks and thick tails and the use of this distribution improves the robustness of the model to anomalies and is particularly suitable for financial time series. As our variables are most financial time series data, a Laplace distribution is more suitable to apply to our error term.</p>
<p>Following <a href="https://ieeexplore.ieee.org/document/1618702">Eltoft,Kim, and Lee 2006b</a>, for covariance with a general Kronecker structure, if each <span class="math inline">\({\lambda_t}\)</span> has an independent exponential distribution with mean <span class="math inline">\({\alpha}\)</span>, then marginally <span class="math inline">\({U_t}\)</span> has a multivariate Laplace distribution with mean vector 0 and covariance matrix <span class="math inline">\({\alpha\Sigma}\)</span>.</p>
<span class="math display">\[\begin{align}

vec(U)&amp;\sim N(0,\Sigma\otimes \Omega)\\

U_t &amp;\sim \text{Laplace}(0, \alpha\Sigma) \\

U_t | \lambda_t &amp;\sim \mathcal{MN}(0, \Sigma, \Omega) \\

\lambda_t &amp;\sim \text{Exponential}(\frac{1}{\alpha})
\end{align}\]</span>
<p>The model is where <span class="math inline">\(\Omega=diag(\lambda_1,\lambda_2,...,\lambda_t)\)</span>, each lambda independently drawn from an exponential distribution.</p>
<p>The kernel of the likelihood function now is :</p>
<span class="math display">\[\begin{align}
L(A,\Sigma,\Omega |Y,X) &amp;\propto \det(\Sigma)^{-\frac{T}{2}} \det(\Omega)^{-\frac{N}{2}} exp\{-\frac{1}{2} tr[\Sigma^{-1} (Y-XA)' \Omega^{-1} (Y-XA) ]\}\\
&amp;=\det(\Sigma)^{-\frac{T}{2}}\prod^{T}_{t = 1} \lambda_t^{-\frac{N}{2}} exp({-\frac{1}{2}}\sum^{T}_{t =1}{\frac{1}{\lambda_t}} \epsilon_t' \Sigma^{-1}\epsilon_t)\\
&amp;=\det(\Sigma)^{-\frac{T}{2}}\prod^{T}_{t = 1}( \lambda_t^{-\frac{N}{2}} exp({-\frac{1}{2}}{\frac{1}{\lambda_t}} \epsilon_t' \Sigma^{-1}\epsilon_t))
\end{align}\]</span>
<p>Thence, for each time t, we have the likelihood like:</p>
<span class="math display">\[\begin{align}
&amp;=\lambda_t^{-\frac{N}{2}} exp({-\frac{1}{2}}{\frac{1}{\lambda_t}} \epsilon_t' \Sigma^{-1}\epsilon_t)
\end{align}\]</span>
<p>For posteriors distribution, <span class="math inline">\(A\)</span>, <span class="math inline">\(\Sigma\)</span> and <span class="math inline">\(\lambda_t\)</span> can then be derived using the likelihood and the prior distributions as follows:</p>
<span class="math display">\[\begin{align}
p(A,\Sigma|Y,X) &amp;\propto L(A,\Sigma,\lambda_t|Y,X)p(A,\Sigma) \\
\\
&amp;= \det(\Sigma)^{-\frac{T}{2}} \det(\Omega)^{-\frac{N}{2}} exp\{-\frac{1}{2} tr[\Sigma^{-1} (Y-XA)' \Omega^{-1} (Y-XA) ]\} \\
&amp;\times \det(\Sigma)^{-\frac{N+k+\underline{\nu}+1}{2}} exp\{-\frac{1}{2}tr[\Sigma^{-1}(A-\underline{A})'(\underline{V})^{-1}(A-\underline{A})]\} \\
&amp;\times exp\{-\frac{1}{2}tr[\Sigma^{-1}\underline{S}]\} \\
&amp;= \det(\Sigma)^{-\frac{T+N+K+\underline{\nu}+1}{2}} \det(\Omega)^{-\frac{N}{2}} \\
&amp;\times exp\{-\frac{1}{2} tr[\Sigma^{-1}(Y'\Omega^{-1}Y - 2A'X'\Omega)^{-1}Y + A'X'\Omega^{-1}XA \\
&amp;+ A'\underline{V}^{-1}A -2A'\underline{V}^{-1}\underline{A} + \underline{A}'\underline{V}^{-1}\underline{A} + \underline{S})]\}

\end{align}\]</span>
<p>The kernel can be rearranged in the form of the <strong>Matrix-variate normal-inverse Wishart distribution</strong>.</p>
<span class="math display">\[\begin{align}
p(A,\Sigma|Y,X) &amp;\sim MNIW(\bar{A},\bar{V},\bar{S},\bar{\nu}) \\
&amp;\\
\bar{V} &amp;= (X'\Omega^{-1}X + \underline{V}^{-1})^{-1} \\
\bar{A} &amp;= \bar{V}(X'\Omega^{-1}Y + \underline{V}^{-1}\underline{A}) \\
\bar{\nu} &amp;= T + \underline{\nu}\\
\bar{S} &amp;= Y'\Omega^{-1}Y + \underline{A}'\underline{V}^{-1}\underline{A} + \underline{S} - \bar{A}'\bar{V}^{-1}\bar{A}
\end{align}\]</span>
<p>The prior distribution of <span class="math display">\[\lambda_t \sim \text{Exponential}(\frac{1}{\alpha})\]</span> define as:</p>
<span class="math display">\[\begin{align}
p(\lambda_t|\alpha) &amp;= \frac{1}{\alpha}exp\{ -\frac{1}{\alpha}\lambda_t \}\\

\end{align} \]</span>
<p>The kernel of the fully conditional posterior distribution of <span class="math inline">\(\lambda_t\)</span> is then derived as follows:</p>
<span class="math display">\[\begin{align}
p(\lambda_t|Y,X,A,\Sigma) &amp;\propto L(A,\Sigma,\lambda_t|Y,X)p(\lambda_t) \\
\\
&amp;\propto \lambda_t^{-\frac{N}{2}}exp({-\frac{1}{2}}{\frac{1}{\lambda_t}}\epsilon_t' \Sigma^{-1}\epsilon_t) \\
&amp;\times \frac{1}{\alpha}exp\{ -\frac{1}{\alpha}\lambda_t \}\\


&amp;= \lambda_t^{-\frac{N}{2}+1-1} exp\{-\frac{1}{2}[\frac{
\epsilon_t' \Sigma^{-1}\epsilon_t} {\lambda_t} +\frac{2}{\alpha}\lambda_t]\}
\end{align}\]</span>
<p>The above expression can be rearranged in the form of a Generalized inverse Gaussian distribution kernel as follows:</p>
<span class="math display">\[\begin{align}
\lambda_t|Y,A,\Sigma &amp;\sim GIG(a,b,p) \\
\\
a &amp;=\frac{2}{\alpha} \\
b &amp;= \epsilon_t' \Sigma^{-1}\epsilon_t \\
p &amp;= -\frac{N}{2}+1
\end{align}\]</span>
<p>The Gibbs sampler method will be applied to generate random draws from the full conditional posterior distribution:</p>
<ol type="1">
<li>Draw <span class="math inline">\(\Sigma^{(s)}\)</span> from the <span class="math inline">\(IW(\bar{S},\bar{\nu})\)</span> distribution.</li>
<li>Draw <span class="math inline">\(A^{(s)}\)</span> from the <span class="math inline">\(MN(\bar{A},\Sigma^{(s)}, \bar{V})\)</span> distribution.</li>
<li>Draw <span class="math inline">\(\lambda_t^{(s)}\)</span> from <span class="math inline">\(GIG(a,b,p)\)</span>.</li>
</ol>
<p>Repeat steps 1, step 2 and 3 for <span class="math inline">\(S_1\)</span>+<span class="math inline">\(S_2\)</span>times.</p>
<p>Discard the first draws that allowed the algorithm to converge to the stationary posterior distribution.</p>
<p>Output is <span class="math inline">\(\left\{ {A^{(s)}, \Sigma^{(s)}}, \lambda_t^{(s)}\right\}^{S_1+S_2}_{s=S_1+1}\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>posterior.draws.extended <span class="ot">&lt;-</span> <span class="cf">function</span>(S1,total_S,Y, X, A.prior, V.prior, S.prior, nu.prior, lambda.priors){</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  Sigma.posterior.draws <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="fu">c</span>(N,N,total_S))</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  A.posterior.draws <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="fu">c</span>((<span class="dv">1</span><span class="sc">+</span>p<span class="sc">*</span>N),N,total_S))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  lambda.posterior.draws <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(T,total_S<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>total_S){</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (s <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>      lambda.s <span class="ot">=</span> lambda<span class="fl">.0</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>      lambda.s    <span class="ot">=</span> lambda.posterior.draws[,s]</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    Omega <span class="ot">=</span> (<span class="fu">diag</span>(lambda.s))</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    Omega.inv <span class="ot">=</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span>lambda.s)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    V.bar.inv.ext   <span class="ot">=</span> <span class="fu">t</span>(X)<span class="sc">%*%</span>Omega.inv<span class="sc">%*%</span>X <span class="sc">+</span> V.prior.inv</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    V.bar.inv.ext   <span class="ot">=</span> <span class="fl">0.5</span> <span class="sc">*</span> (<span class="fu">t</span>(V.bar.inv.ext) <span class="sc">+</span> V.bar.inv.ext)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    V.bar.ext       <span class="ot">=</span> <span class="fu">solve</span>(V.bar.inv.ext)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    V.bar.ext       <span class="ot">=</span> <span class="fl">0.5</span> <span class="sc">*</span> (<span class="fu">t</span>(V.bar.ext) <span class="sc">+</span> V.bar.ext)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    A.bar.ext       <span class="ot">=</span> V.bar.ext<span class="sc">%*%</span>(<span class="fu">t</span>(X)<span class="sc">%*%</span>Omega.inv<span class="sc">%*%</span>Y <span class="sc">+</span> V.prior.inv<span class="sc">%*%</span>A.prior)</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    nu.bar.ext      <span class="ot">=</span> T <span class="sc">+</span> nu.prior</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    S.bar.ext       <span class="ot">=</span> S.prior <span class="sc">+</span> <span class="fu">t</span>(Y)<span class="sc">%*%</span>Omega.inv<span class="sc">%*%</span>Y <span class="sc">+</span> <span class="fu">t</span>(A.prior)<span class="sc">%*%</span>V.prior.inv<span class="sc">%*%</span>A.prior <span class="sc">-</span> <span class="fu">t</span>(A.bar.ext)<span class="sc">%*%</span>V.bar.inv.ext<span class="sc">%*%</span>A.bar.ext</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    S.bar.ext       <span class="ot">=</span> <span class="fl">0.5</span> <span class="sc">*</span> (<span class="fu">t</span>(S.bar.ext) <span class="sc">+</span> S.bar.ext)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>    S.bar.ext.inv   <span class="ot">=</span> <span class="fu">solve</span>(S.bar.ext)</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>    S.bar.ext.inv   <span class="ot">=</span> <span class="fl">0.5</span> <span class="sc">*</span> (<span class="fu">t</span>(S.bar.ext.inv) <span class="sc">+</span> S.bar.ext.inv)</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>    Sigma.inv.draw <span class="ot">=</span> <span class="fu">rWishart</span>(<span class="dv">1</span>, <span class="at">df =</span> nu.bar.ext, <span class="at">Sigma =</span> S.bar.ext.inv)[,,<span class="dv">1</span>]</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>    Sigma.posterior.draws[,,s] <span class="ot">=</span> <span class="fu">solve</span>(Sigma.inv.draw)</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>    A.posterior.draws[,,s] <span class="ot">=</span> <span class="fu">matrix</span>(mvtnorm<span class="sc">::</span><span class="fu">rmvnorm</span>(<span class="dv">1</span>, <span class="at">mean=</span><span class="fu">as.vector</span>(A.bar.ext), <span class="at">sigma =</span> Sigma.posterior.draws[,,s] <span class="sc">%x%</span> V.bar.ext), <span class="at">ncol=</span>N)</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>    u.t <span class="ot">=</span> Y<span class="sc">-</span>X<span class="sc">%*%</span>A.posterior.draws[,,s]</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>    <span class="co">#    ---- loop lambda posterior ----   #</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>    c                      <span class="ot">=</span> <span class="sc">-</span>N<span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span>          <span class="co"># N=13</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>    a                      <span class="ot">=</span> <span class="dv">2</span> <span class="sc">/</span> lambda.priors<span class="sc">$</span>alpha</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (x <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>T){</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>      b                  <span class="ot">=</span> <span class="fu">t</span>((u.t)[x,])<span class="sc">%*%</span> Sigma.inv.draw <span class="sc">%*%</span>(u.t)[x,]</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>      lambda.posterior.draws[x,s<span class="sc">+</span><span class="dv">1</span>] <span class="ot">=</span> GIGrvg<span class="sc">::</span><span class="fu">rgig</span>(<span class="dv">1</span>, <span class="at">lambda =</span> c, <span class="at">chi =</span> b, <span class="at">psi =</span> a)</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>    } <span class="co"># </span><span class="re">END</span><span class="co"> x loop</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>  } <span class="co"># </span><span class="re">END</span><span class="co"> s loop</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>  output                 <span class="ot">=</span> (<span class="fu">list</span>(<span class="at">A.posterior.exten =</span> A.posterior.draws[,,S1<span class="sc">:</span>total_S], </span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">Sigma.posterior.exten =</span> Sigma.posterior.draws[,,S1<span class="sc">:</span>total_S], </span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">lambda.posterior.exten =</span> lambda.posterior.draws[,(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(total_S<span class="sc">+</span><span class="dv">1</span>)]))</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="estimation-outcomes-on-extended-model" class="level3">
<h3 class="anchored" data-anchor-id="estimation-outcomes-on-extended-model">Estimation Outcomes on Extended Model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">round</span>(<span class="fu">apply</span>(posterior.ext<span class="sc">$</span>A.posterior.exten, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, mean),<span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]     [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
[1,]  0.001184 0.005815  0.007066  0.006149  0.126937  0.016707  0.013198
[2,]  0.999970 0.000000  0.000001 -0.000331  0.000130  0.000027  0.000038
[3,] -0.000003 1.000003 -0.000001  0.000364 -0.000117 -0.000038 -0.000019
[4,]  0.000002 0.000004  0.999997  0.000502  0.000014 -0.000043 -0.000013
[5,]  0.000285 0.000037  0.000030  0.995288 -0.001983  0.000246  0.000306
[6,] -0.000179 0.000018  0.000021  0.001652  0.994441  0.000157 -0.000044
          [,8]      [,9]     [,10]     [,11]     [,12]     [,13]
[1,]  0.015776  0.018418  0.007535  0.007276 -0.120121 -0.040701
[2,]  0.000072  0.000009 -0.000002 -0.000006  0.000324 -0.000233
[3,] -0.000011 -0.000063 -0.000007 -0.000006  0.000102 -0.000132
[4,] -0.000028 -0.000051 -0.000007 -0.000004  0.000089 -0.000064
[5,]  0.000070  0.000344 -0.000012 -0.000009  0.003846  0.004803
[6,] -0.000033  0.000047  0.000026  0.000058  0.000402  0.003178</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">round</span>(<span class="fu">apply</span>(posterior.ext<span class="sc">$</span>Sigma.posterior.exten, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, mean),<span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]     [,2]     [,3]     [,4]      [,5]      [,6]     [,7]
[1,]  0.001476 0.000012 0.000028 0.002524 -0.000960 -0.000398 0.000240
[2,]  0.000012 0.000020 0.000011 0.000511  0.000178  0.000014 0.000035
[3,]  0.000028 0.000011 0.000055 0.000388  0.001163  0.000050 0.000053
[4,]  0.002524 0.000511 0.000388 0.129111  0.035261  0.000228 0.002727
[5,] -0.000960 0.000178 0.001163 0.035261  0.367521  0.001752 0.001545
[6,] -0.000398 0.000014 0.000050 0.000228  0.001752  0.001858 0.000260
          [,8]     [,9]     [,10]     [,11]     [,12]     [,13]
[1,] -0.001080 0.000184  0.000026  0.000031 -0.001382  0.000980
[2,]  0.000051 0.000030 -0.000001 -0.000002 -0.000146 -0.000038
[3,]  0.000052 0.000049  0.000001  0.000000 -0.000109 -0.000072
[4,]  0.000154 0.003373  0.000247  0.000212 -0.021608 -0.018753
[5,]  0.002409 0.002985 -0.000249  0.000168 -0.017547 -0.035447
[6,]  0.001176 0.000320  0.000025  0.000027 -0.001182 -0.002020</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">mean</span>(posterior.ext<span class="sc">$</span>lambda.posterior.exten),<span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.589784</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(posterior.ext<span class="sc">$</span>A.posterior.exten[<span class="dv">1</span>,<span class="dv">1</span>,], <span class="at">xlab =</span> <span class="st">"Simulation times S"</span>, <span class="at">ylab =</span> <span class="st">"AUD/USD exchange rate.exten"</span>, <span class="at">col =</span> mcxs1)   </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior.ext<span class="sc">$</span>A.posterior.exten[<span class="dv">1</span>,<span class="dv">1</span>,], <span class="at">xlab =</span> <span class="st">"AUD/USD exchange rate.exten"</span>, <span class="at">col =</span> mcxs1, <span class="at">main =</span> <span class="st">''</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(posterior.ext<span class="sc">$</span>Sigma.posterior.exten[<span class="dv">1</span>,<span class="dv">1</span>,], <span class="at">xlab =</span> <span class="st">"Simulation times S"</span>, <span class="at">ylab =</span> <span class="st">"AUD/USD exchange rate sigma.exten"</span>, <span class="at">col =</span> mcxs2) </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior.ext<span class="sc">$</span>Sigma.posterior.exten[<span class="dv">1</span>,<span class="dv">1</span>,], <span class="at">xlab =</span> <span class="st">"AUD/USD exchange sigma.exten"</span>, <span class="at">col =</span> mcxs2, <span class="at">main =</span> <span class="st">''</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(posterior.ext<span class="sc">$</span>lambda.posterior.exten[(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>total_S], <span class="at">xlab =</span> <span class="st">"Simulation times S"</span>, <span class="at">ylab =</span> <span class="st">"lambda"</span>, <span class="at">col =</span> mcxs3)         </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior.ext<span class="sc">$</span>lambda.posterior.exten[(S1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>total_S], <span class="at">xlab =</span> <span class="st">"lambda"</span>, <span class="at">col =</span> mcxs3, <span class="at">main =</span> <span class="st">''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Compared to the basic model, by applying laplace distribution into the variance specification of the error term, we introduces more variability to our <span class="math inline">\(A\)</span> and <span class="math inline">\(\Sigma\)</span>. That is, the distribution of the coefficient now more dispersion with the basic model more concentrate 0. And for the distribution of Sigma, it shows the similar shape but central around different value.</p>
<p>The lambda mainly concentrates between 0 to 4, with some large outlines throughout the simulation.</p>
</section>
</section>
<section id="the-basic-model-with-stochastic-volatility-heteroskedasticity" class="level2">
<h2 class="anchored" data-anchor-id="the-basic-model-with-stochastic-volatility-heteroskedasticity">The Basic Model With Stochastic Volatility Heteroskedasticity</h2>
<p>The second modification enhances the model by capturing stochastic volatility in the error terms, which means the variance might vary over time according to a stochastic process. This adjustment allows the model to specifically account for heteroskedasticity, creating a more dynamic error structure. By integrating this feature with the earlier enhancement that introduced laplace errors, the model becomes significantly more robust in handling error variability.</p>
<p>With the stochastic volatility in innovation term, the basic model now is:</p>
<span class="math display">\[\begin{align}
Y &amp;= X A + U
\\
U |X &amp;\sim \mathcal{MN}_{T\times 13}(0,\Sigma,\mathrm{diag}(\sigma_{T}^{2}))
\end{align} \]</span>
<p>With <span class="math inline">\(\mathrm{diag}(\sigma_{T}^{2})=diag(e^{h_1},e^{h_2},...,e^{h_T})\)</span>, represent as:</p>
<p>Where <span class="math inline">\(h_t\)</span> follows an AR(1) process:</p>
<span class="math display">\[\begin{align}
h_t &amp;= h_{t-1} + \sigma_v v_t \\
v_t &amp;\sim \mathcal{N}(0,1) \\
\sigma^2_v &amp;\sim IG2(\bar{s},\bar{\nu})
\end{align}\]</span>
<p>The basic heteroskedasticity model is still based on Natural-conjugate prior distribution, where the <span class="math inline">\(A\)</span> follows a Matrix-variate Normal distribution and <span class="math inline">\(\Sigma\)</span> follows an Inverse Wishart distribution.</p>
<p>With the likelihood function now changes to :</p>
<span class="math display">\[\begin{align}
L\left( {A},{\Sigma}|Y,X \right) &amp;\propto \text{det}({\Sigma})^{-\frac{T}{2}}\exp\left\{ -\frac{1}{2}\text{tr}\left[ {\Sigma}^{-1}(Y-X{A})'(Y-X{A}) \right] \right\}\\
&amp;=\text{det}({\Sigma})^{-\frac{T}{2}}\\
&amp;\quad\times\exp\left\{ -\frac{1}{2}\text{tr}\left[ {\Sigma}^{-1}({A}-\widehat{A})'X' \ \mathrm{diag}(\sigma_{T}^{2})^{-1} \ X({A}-\widehat{A}) \right] \right\}\\
&amp;\quad\times \exp\left\{ -\frac{1}{2}\text{tr}\left[ {\Sigma}^{-1}(Y-X\widehat{A})' \ \mathrm{diag}(\sigma_{T}^{2})^{-1} \ (Y-X\widehat{A}) \right] \right\}
\end{align} \]</span>
<p>For posterior distribution,</p>
<span class="math display">\[\begin{align}
p\left( {A},{\Sigma} |Y,X\right)
&amp;\propto  \text{det}({\Sigma})^{-\frac{T}{2}}\\
&amp;\quad\times\exp\left\{ -\frac{1}{2}\text{tr}\left[ {\Sigma}^{-1}({A}-\widehat{A})'X' \ \mathrm{diag}(\sigma_{T}^{2})^{-1} \ X({A}-\widehat{A}) \right] \right\}\\
&amp;\quad\times \exp\left\{ -\frac{1}{2}\text{tr}\left[ {\Sigma}^{-1}(Y-X\widehat{A})' \ \mathrm{diag}(\sigma_{T}^{2})^{-1} \ (Y-X\widehat{A}) \right] \right\}\\
&amp; \quad\times\text{det}({\Sigma})^{-\frac{N+K+\underline{\nu}+1}{2}}\\
&amp;\quad\times\exp\left\{ -\frac{1}{2}\text{tr}\left[ {\Sigma}^{-1}({A}-\underline{A})'\underline{V}^{-1}({A}-\underline{A}) \right] \right\}\\
&amp;\quad\times \exp\left\{ -\frac{1}{2}\text{tr}\left[ {\Sigma}^{-1}\underline{S} \right] \right\} \\

\end{align}\]</span>
<p>Similarly, the kernel can be rearranged in the form of the Matrix-variate normal-inverse Wishart distribution.</p>
<span class="math display">\[\begin{align}
\bar{V} &amp;= (X'\mathrm{diag}(\sigma_{T}^{2})^{-1}X + \underline{V}^{-1})^{-1}\\
\bar{A} &amp;= \bar{V}(X'\mathrm{diag}(\sigma_{T}^{2})^{-1}Y+\underline{V}^{-1}\underline{A})\\
\bar{\nu} &amp;= T+\underline{\nu}\\
\bar{S} &amp;= Y'\mathrm{diag}(\sigma_{T}^{2})^{-1}Y+\underline{A}'\underline{V}^{-1}\underline{A}-\bar{A'}\bar{V}^{-1}\bar{A}+\underline{S}
\end{align}\]</span>
<section id="estimation-outcomes-on-basic-stochastic-volatility-model" class="level3">
<h3 class="anchored" data-anchor-id="estimation-outcomes-on-basic-stochastic-volatility-model">Estimation Outcomes on Basic Stochastic Volatility Model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">round</span>(<span class="fu">apply</span>(A.posterior.heter, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, mean),<span class="dv">6</span>))         <span class="co"># posterior draw A</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
[1,]  0.005520  0.005469  0.005497 -0.047023  0.057079  0.010392  0.014101
[2,]  0.999997  0.000000  0.000000 -0.000032 -0.000030  0.000005  0.000001
[3,]  0.000004  1.000001 -0.000001  0.000094  0.000044 -0.000006 -0.000002
[4,]  0.000002  0.000001  0.999999  0.000063  0.000053 -0.000003 -0.000001
[5,]  0.000000 -0.000004  0.000001  0.999252 -0.000274 -0.000013  0.000014
[6,] -0.000012 -0.000001 -0.000006 -0.000119  0.999503 -0.000031  0.000000
          [,8]      [,9]     [,10]    [,11]    [,12]     [,13]
[1,]  0.015482  0.014708  0.007020 0.007093 0.017148 -0.070498
[2,]  0.000002 -0.000001  0.000000 0.000000 0.000017 -0.000022
[3,] -0.000003 -0.000003 -0.000001 0.000000 0.000047 -0.000032
[4,]  0.000004 -0.000002  0.000000 0.000000 0.000012 -0.000003
[5,] -0.000021  0.000000 -0.000002 0.000000 0.000370  0.000370
[6,] -0.000018 -0.000008  0.000002 0.000005 0.000213  0.000334</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">round</span>(<span class="fu">apply</span>(Sigma.posterior.heter, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, mean),<span class="dv">6</span>))     <span class="co"># posterior draw sigma</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         [,1]     [,2]     [,3]      [,4]      [,5]      [,6]   [,7]      [,8]
[1,]  6.1e-05  0.0e+00 -1.0e-06  0.000060 -0.000083 -0.000034  1e-06 -0.000062
[2,]  0.0e+00  1.0e-06  0.0e+00  0.000030  0.000011 -0.000001  0e+00  0.000000
[3,] -1.0e-06  0.0e+00  2.0e-06 -0.000017  0.000033  0.000001  0e+00 -0.000003
[4,]  6.0e-05  3.0e-05 -1.7e-05  0.007490 -0.000490 -0.000191 -4e-06 -0.000060
[5,] -8.3e-05  1.1e-05  3.3e-05 -0.000490  0.021187  0.000152 -6e-05 -0.000141
[6,] -3.4e-05 -1.0e-06  1.0e-06 -0.000191  0.000152  0.000147  1e-05  0.000054
         [,9]  [,10]    [,11]     [,12]     [,13]
[1,] -2.0e-06 -1e-06  0.0e+00 -0.000019  0.000063
[2,]  1.0e-06  0e+00  0.0e+00 -0.000010 -0.000008
[3,]  1.0e-06  0e+00  0.0e+00 -0.000013 -0.000003
[4,] -2.0e-06  2e-06 -6.0e-06 -0.000486 -0.000796
[5,] -2.8e-05 -5e-05 -1.4e-05 -0.001386 -0.001057
[6,]  1.6e-05  3e-06  1.0e-06 -0.000216 -0.000032</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(A.posterior.heter[<span class="dv">1</span>,<span class="dv">1</span>,], <span class="at">xlab =</span> <span class="st">"Simulation times S"</span>, <span class="at">ylab =</span> <span class="st">"AUD/USD exchange rate"</span>, <span class="at">col =</span> mcxs1)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(A.posterior.heter[<span class="dv">1</span>,<span class="dv">1</span>,], <span class="at">xlab =</span> <span class="st">"AUD/USD exchange rate"</span>, <span class="at">col =</span> mcxs1, <span class="at">main =</span> <span class="st">''</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(Sigma.posterior.heter[<span class="dv">1</span>,<span class="dv">1</span>,], <span class="at">xlab =</span> <span class="st">"Simulation times S"</span>, <span class="at">ylab =</span> <span class="st">"AUD/USD exchange rate sigma"</span>, <span class="at">col =</span> mcxs2)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Sigma.posterior.heter[<span class="dv">1</span>,<span class="dv">1</span>,], <span class="at">xlab =</span> <span class="st">"AUD/USD exchange rate sigma"</span>, <span class="at">col =</span> mcxs2, <span class="at">main =</span> <span class="st">''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can notice that compared to the above two models, the involve of the heteroskedasticity brings out outliers, and these outliers seems all around the zero, with the coefficient also central round 1 and the sigma more central around zero. The change is obvious and significant, which will be demonstrated in the following forecasting plot.</p>
</section>
</section>
<section id="the-extension-model-with-stochastic-volatility-heteroskedasticity" class="level2">
<h2 class="anchored" data-anchor-id="the-extension-model-with-stochastic-volatility-heteroskedasticity">The Extension Model With Stochastic Volatility Heteroskedasticity</h2>
<p>With stochastic volatility heteroskedasticity in our extended model, we have: <span class="math inline">\(\Omega=diag(e^{h_1}\lambda_1,e^{h_2}\lambda_2,...,e^{h_T}\lambda_t)\)</span>, represents as:</p>
<p><span class="math display">\[\\\Omega = \left(
\begin{array}{cccc}
e^{h_1}\lambda_1 &amp; 0 &amp; \cdots &amp; 0 \\
0 &amp; e^{h_2}\lambda_2 &amp; \cdots &amp; \vdots \\
0 &amp; \cdots &amp; \ddots &amp; \vdots \\
0 &amp; \cdots &amp; 0 &amp;  e^{h_T}\lambda_T\\
\end{array}
\right)\]</span></p>
<p>The likelihood function now change to:</p>
<span class="math display">\[\begin{align}
L(A,\Sigma,\Omega |Y,X) &amp;\propto \det(\Sigma)^{-\frac{T}{2}} \det(\Omega)^{-\frac{N}{2}} exp\{-\frac{1}{2} tr[\Sigma^{-1} (Y-XA)' \Omega^{-1} (Y-XA) ]\}\\
&amp;=\det(\Sigma)^{-\frac{T}{2}}\prod^{T}_{t = 1} (e^{h_t}\lambda_t)^{-\frac{N}{2}} exp({-\frac{1}{2}}\sum^{T}_{t =1}{\frac{1}{e^{h_t}\lambda_t}} \epsilon_t' \Sigma^{-1}\epsilon_t)\\
&amp;=\det(\Sigma)^{-\frac{T}{2}}\prod^{T}_{t = 1}( (e^{h_t}\lambda_t)^{-\frac{N}{2}} exp({-\frac{1}{2}}{\frac{1}{e^{h_t}\lambda_t}} \epsilon_t' \Sigma^{-1}\epsilon_t))
\end{align}\]</span>
<p>For posterior distribution,</p>
<span class="math display">\[\begin{align}
p(\lambda_t|Y,X,A,\Sigma) &amp;\propto L(A,\Sigma,\lambda_t|Y,X)p(\lambda_t) \\
\\
&amp;\propto (e^{h_t}\lambda_t)^{-\frac{N}{2}} exp({-\frac{1}{2}}{\frac{1}{e^{h_t}\lambda_t}} \epsilon_t' \Sigma^{-1}\epsilon_t) \\
&amp;\times \frac{1}{\alpha}exp\{ -\frac{1}{\alpha}\lambda_t \}\\


&amp;= \lambda_t^{-\frac{N}{2}+1-1} exp\{-\frac{1}{2}[\frac{
\epsilon_t'e^{-h_t}\Sigma^{-1}\epsilon_t} {\lambda_t} +\frac{2}{\alpha}\lambda_t]\}
\end{align}\]</span>
<span class="math display">\[\begin{align}
\lambda_t|Y,A,\Sigma &amp;\sim GIG(a,b,p) \\
\\
a &amp;=\frac{2}{\alpha} \\
b &amp;= \epsilon_t' e^{-h_t}\Sigma^{-1}\epsilon_t \\
p &amp;= -\frac{N}{2}+1
\end{align}\]</span>
<p>Gibbs Sampling Routine for SV and Laplace Distributed Errors</p>
<p>Initialize <span class="math inline">\(\lambda^{(0)}\)</span> and <span class="math inline">\(h_t^{(0)}\)</span>.</p>
<p>At each iteration s:</p>
<ol type="1">
<li>Draw <span class="math inline">\(\Sigma^{(s)}\)</span> from the <span class="math inline">\(IW(\bar{S},\bar{\nu})\)</span> distribution</li>
<li>Draw <span class="math inline">\(A^{(s)}\)</span> from the <span class="math inline">\(MN(\bar{A},\Sigma^{(s)}, \bar{V})\)</span> distribution</li>
<li>Draw <span class="math inline">\(\lambda_t^{(s)}\)</span> from <span class="math inline">\(GIG(a,b,p)\)</span></li>
<li>Draw <span class="math inline">\(h^{(s)}\)</span> from the SV sampling routine described above</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">round</span>(<span class="fu">apply</span>(posterior.draws.heter.ext<span class="sc">$</span>Sigma.posterior, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, mean),<span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]      [,2]     [,3]     [,4]     [,5]      [,6]     [,7]
[1,]  0.001748 -0.000011 0.000054 0.004243 0.000652 -0.000440 0.000177
[2,] -0.000011  0.000034 0.000018 0.000939 0.000570  0.000027 0.000112
[3,]  0.000054  0.000018 0.000073 0.001040 0.001930  0.000056 0.000113
[4,]  0.004243  0.000939 0.001040 0.228606 0.081725  0.002532 0.006125
[5,]  0.000652  0.000570 0.001930 0.081725 0.487819  0.004447 0.004414
[6,] -0.000440  0.000027 0.000056 0.002532 0.004447  0.002519 0.000629
          [,8]     [,9]     [,10]    [,11]     [,12]     [,13]
[1,] -0.001369 0.000172  0.000010 0.000023 -0.000270  0.002262
[2,]  0.000089 0.000108  0.000016 0.000018 -0.000722 -0.001693
[3,]  0.000093 0.000115  0.000007 0.000012 -0.000349 -0.000890
[4,]  0.001508 0.007324  0.000407 0.000875 -0.042629 -0.058830
[5,]  0.003225 0.004838 -0.000236 0.000594 -0.027237 -0.056852
[6,]  0.001708 0.000783  0.000116 0.000108 -0.004753 -0.007247</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">round</span>(<span class="fu">apply</span>(posterior.draws.heter.ext<span class="sc">$</span>A.posterior, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, mean),<span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
[1,]  0.010941 -0.017893 -0.005026 -0.009278 -0.021426  0.000533 -0.002469
[2,] -0.008914  0.012570  0.013816  0.012148 -0.000773 -0.006951  0.010760
[3,] -0.016836  0.002213  0.003431  0.013667 -0.003291  0.007056 -0.007025
[4,]  0.018453 -0.007552 -0.015336 -0.006197  0.008030 -0.003768 -0.016066
[5,] -0.003943 -0.000569  0.002906 -0.002166  0.004395  0.000259  0.003756
[6,]  0.008116 -0.006178 -0.008465 -0.003980 -0.007993  0.006197 -0.006969
          [,8]      [,9]     [,10]     [,11]     [,12]     [,13]
[1,]  0.003114 -0.002409  0.013222 -0.008543 -0.014699 -0.009912
[2,] -0.002427 -0.000458 -0.005868 -0.015554 -0.002634  0.007291
[3,] -0.008042  0.001950 -0.003973  0.001888  0.013728 -0.000739
[4,] -0.001515 -0.000413 -0.005543 -0.002105 -0.011641 -0.018743
[5,] -0.000358 -0.009886 -0.015142  0.002379  0.007866  0.008620
[6,]  0.004981 -0.022774  0.010009 -0.010843 -0.000266 -0.009447</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(posterior.draws.heter.ext<span class="sc">$</span>A.posterior[<span class="dv">1</span>,<span class="dv">1</span>,], <span class="at">xlab =</span> <span class="st">"Simulation times S"</span>, <span class="at">ylab =</span> <span class="st">"AUD/USD exchange rate"</span>, <span class="at">col =</span> mcxs1)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior.draws.heter.ext<span class="sc">$</span>A.posterior[<span class="dv">1</span>,<span class="dv">1</span>,], <span class="at">xlab =</span> <span class="st">"AUD/USD exchange rate"</span>, <span class="at">col =</span> mcxs1, <span class="at">main =</span> <span class="st">''</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(posterior.draws.heter.ext<span class="sc">$</span>Sigma.posterior[<span class="dv">1</span>,<span class="dv">1</span>,], <span class="at">xlab =</span> <span class="st">"Simulation times S"</span>, <span class="at">ylab =</span> <span class="st">"AUD/USD exchange rate sigma"</span>, <span class="at">col =</span> mcxs2)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(posterior.draws.heter.ext<span class="sc">$</span>Sigma.posterior[<span class="dv">1</span>,<span class="dv">1</span>,], <span class="at">xlab =</span> <span class="st">"AUD/USD exchange rate sigma"</span>, <span class="at">col =</span> mcxs2, <span class="at">main =</span> <span class="st">''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>For extended model with heteroskedasticity, the coefficient range now wider a lot, which ranges from -3 to 3.</p>
</section>
<section id="proof-of-model-validity" class="level2">
<h2 class="anchored" data-anchor-id="proof-of-model-validity">Proof of Model Validity</h2>
<section id="proof-of-basic-model-validity" class="level3">
<h3 class="anchored" data-anchor-id="proof-of-basic-model-validity">Proof of Basic Model Validity</h3>
<p>To test the model validity, we simulated 1000 observations from a bi-variate Gaussian random walk process with the covariance matrix equal to the identity matrix of order 2 to see how the autoregressive and the covariance matrices and the posterior mean of the constant term behave.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Posterior mean of the covariance matrix Sigma</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Simulation_Y1</th>
<th style="text-align: right;">Simulation_Y2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Y1-Lag</td>
<td style="text-align: right;">0.9796123</td>
<td style="text-align: right;">0.0878079</td>
</tr>
<tr class="even">
<td style="text-align: left;">Y2-Lag</td>
<td style="text-align: right;">0.0878079</td>
<td style="text-align: right;">1.0176700</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Posterior mean of the autoregressive coefficient matrix A</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Simulation_Y1</th>
<th style="text-align: right;">Simulation_Y2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Constant</td>
<td style="text-align: right;">0.0603819</td>
<td style="text-align: right;">0.0811782</td>
</tr>
<tr class="even">
<td style="text-align: left;">Y1-Lag</td>
<td style="text-align: right;">0.9894262</td>
<td style="text-align: right;">0.0047783</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Y2-Lag</td>
<td style="text-align: right;">0.0023282</td>
<td style="text-align: right;">0.9956869</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The diagonal entries of the covariance matrix are close to 1, which indicates that each variable has a strong autoregressive relationship with itself and similarly, the diagonal elements of the autoregressive coefficient matrix are close to one, suggesting that each variable is heavily influenced by its past value. Besides, the posterior means for the constant terms is close to 0, the above can indicate that the estimated parameter constant term and means are consistent with what we expect given a Minnesota prior.</p>
</section>
<section id="proof-of-extended-model" class="level3">
<h3 class="anchored" data-anchor-id="proof-of-extended-model">Proof of Extended Model</h3>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Posterior mean of the covariance matrix Sigma</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Simulation_Y1</th>
<th style="text-align: right;">Simulation_Y2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Y1-Lag</td>
<td style="text-align: right;">1.2311501</td>
<td style="text-align: right;">0.1080764</td>
</tr>
<tr class="even">
<td style="text-align: left;">Y2-Lag</td>
<td style="text-align: right;">0.1080764</td>
<td style="text-align: right;">1.3162664</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Posterior mean of the autoregressive coefficient matrix A</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Simulation_Y1</th>
<th style="text-align: right;">Simulation_Y2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Constant</td>
<td style="text-align: right;">0.0548787</td>
<td style="text-align: right;">0.1056800</td>
</tr>
<tr class="even">
<td style="text-align: left;">Y1-Lag</td>
<td style="text-align: right;">0.9906143</td>
<td style="text-align: right;">0.0094673</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Y2-Lag</td>
<td style="text-align: right;">0.0026284</td>
<td style="text-align: right;">0.9935099</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Similarly, the posterior mean of the autoregressive and the covariance matrices are close to an identity matrix and the posterior mean of the constant term is close to zero, so we can conclude that the extended model is also valid.</p>
</section>
</section>
</section>
<section id="forecasting" class="level1">
<h1>Forecasting</h1>
<p>The forecast will focus on two models with the sample period from 1990 Q1 to 2023Q4, and forecast how the exchange rate changes for the future up to 2026Q4.</p>
<section id="forecasting-with-models" class="level2">
<h2 class="anchored" data-anchor-id="forecasting-with-models">Forecasting With Models</h2>
<section id="forecasting-with-basic-model" class="level3">
<h3 class="anchored" data-anchor-id="forecasting-with-basic-model">Forecasting With Basic Model</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The above presents the historical and forecasting data the AUD/USD exchange rate for basic and extended model.</p>
<p>For the point forecast, for basic model, the exchange rate shows several peaks and troughs, indicating the volatility in the exchange rate over the years. For the three years forecasting, it shows a slightly downward trend and reaching around 0.62 in 2026.</p>
</section>
<section id="forecasting-on-extended-model" class="level3">
<h3 class="anchored" data-anchor-id="forecasting-on-extended-model">Forecasting on Extended Model</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>For extended model, it shows a clear increasing trend and reaching around 0.70 in the end of the forecasting period. For conduct 90% confident interval, we can notice the extended model has an wider confident interval, and this may be given by the nature of the Laplace distribution applied in the extended model in which the the fatter fail of Laplace distribution will capture more economic activities not covered by the underlying normal distribution.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Regard to the 3D with density intervals above for both model forecasting, we could notice that the for each different predictive density at specific horizons, with the back wall we have the one period ahead predictive density and with the front we have the 12 period ahead density which is 3 years. We could see the distribution becomes lower and more dispersed with the increases of the horizon, as the data is more informative about the nearest developments in the future. Hence, one period predictive density is highly concentrated relative to others with smaller variance and taller peak. Similarly, the interval become more wider and dispersed resulting a more uncertainty for the future period forecasting.</p>
</section>
<section id="forecasting-on-basic-model-with-stochastic-volatility-heteroskedasticity" class="level3">
<h3 class="anchored" data-anchor-id="forecasting-on-basic-model-with-stochastic-volatility-heteroskedasticity">Forecasting on Basic Model With Stochastic Volatility Heteroskedasticity</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>By involving the heteroskedasticity in the error term, the forecasting plot looks similar to the extended model, with the heteroskedasticity extension, it shows an increasing trend but reaching to 0.75 and we could notice that the confident interval is slightly narrower compared to the basic model, indicating a more informative estimating of the parameters as it has a higher certainty from a more concentrated mean value and then leading to a narrower confident interval as expected.</p>
</section>
<section id="interactive-3d-versions" class="level3">
<h3 class="anchored" data-anchor-id="interactive-3d-versions">Interactive 3D versions</h3>
<p>Interactive versions of the above 3D plots are provided below.</p>
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-70c4285b1c3b764e7f5d" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-70c4285b1c3b764e7f5d">{"x":{"visdat":{"359a42171a24":["function () ","plotlyVisDat"]},"cur_data":"359a42171a24","attrs":{"359a42171a24":{"y":[1,2,3,4,5,6,7,8,9,10,11,12],"x":[0.18736843088292179,0.31744906920647586,0.44752970753002996,0.57761034585358395,0.70769098417713816,0.83777162250069215,0.96785226082424614,1.0979328991478003,1.2280135374713543],"z":[[0,0,0,1.3876008168951022,6.1853940015168929,0.11454433336142404,0,0,0],[0,0,0.016143832218724188,2.0225915508315864,5.1575700169247867,0.48892749005278985,0.0023062617455320276,0,0],[0,0,0.097631747227522478,2.2324613696750006,4.5310355760552534,0.81411039617280578,0.012300062642837482,0,0],[0,0.0023062617455320259,0.19372598662469026,2.3969747075229519,4.0413393320872864,1.0132176602037375,0.03920644967404447,0.00076875391517734119,0],[0,0.01230006264283747,0.29597025734327681,2.4446374502639472,3.6592686362441476,1.1861872911186395,0.087637946330217056,0.0015375078303546824,0],[0.0015375078303546846,0.023831371370497598,0.45125854820909994,2.38313713704976,3.3694484102222897,1.3253317497657386,0.12684439600426153,0.0061500313214187296,0],[0.00076875391517734228,0.042281465334753805,0.56195911199463722,2.343161933460538,3.1903287479859688,1.3453193515603494,0.18450093964256223,0.01921884787943353,0],[0.0023062617455320267,0.066881590620428741,0.66343462879804638,2.2755115889249322,2.9950652535309241,1.4229634969932612,0.2421574832808629,0.01921884787943353,0],[0.0046125234910640535,0.09071296199092635,0.7572226064496822,2.2186237992018087,2.8589958105445343,1.4237322509084385,0.29904527300398626,0.033056418352625676,0.0015375078303546852],[0.0099938008973054493,0.11685059510695597,0.83025422839152963,2.1932549200009563,2.6983262422724699,1.4421823448726947,0.34517050791462683,0.049200250571349836,0.0023062617455320276],[0.013068816558014819,0.15682579869617774,0.88329824853876626,2.1463609311751384,2.533812904424519,1.4806200406315617,0.41051459070470092,0.060731559299009953,0.0023062617455320276],[0.016912586133901529,0.20833231101305966,0.90559211207890922,2.1163795284832223,2.4146560475720307,1.4852325641226258,0.46355861085193756,0.071494114111492729,0.0053812774062413976]],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface","colors":["#05386B","#8EE4AF","#EDF5E1"],"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"AUD/USD"},"yaxis":{"title":"h-step forecast"},"zaxis":{"title":"density"}},"title":"AUD/USD forecast densities for basic model","hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"colorbar":{"title":"","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(5,56,107,1)"],["0.0416666666666667","rgba(28,69,113,1)"],["0.0833333333333333","rgba(42,81,119,1)"],["0.125","rgba(54,95,125,1)"],["0.166666666666667","rgba(65,109,130,1)"],["0.208333333333333","rgba(76,123,136,1)"],["0.25","rgba(86,137,142,1)"],["0.291666666666667","rgba(95,151,148,1)"],["0.333333333333333","rgba(105,166,153,1)"],["0.375","rgba(114,181,159,1)"],["0.416666666666667","rgba(124,197,164,1)"],["0.458333333333333","rgba(133,212,170,1)"],["0.5","rgba(142,228,175,1)"],["0.541666666666667","rgba(151,230,179,1)"],["0.583333333333333","rgba(159,231,183,1)"],["0.625","rgba(168,233,187,1)"],["0.666666666666667","rgba(176,234,191,1)"],["0.708333333333333","rgba(184,236,196,1)"],["0.75","rgba(192,237,200,1)"],["0.791666666666667","rgba(199,238,204,1)"],["0.833333333333333","rgba(207,240,208,1)"],["0.875","rgba(215,241,212,1)"],["0.916666666666667","rgba(222,242,217,1)"],["0.958333333333333","rgba(230,244,221,1)"],["1","rgba(237,245,225,1)"]],"showscale":true,"y":[1,2,3,4,5,6,7,8,9,10,11,12],"x":[0.18736843088292179,0.31744906920647586,0.44752970753002996,0.57761034585358395,0.70769098417713816,0.83777162250069215,0.96785226082424614,1.0979328991478003,1.2280135374713543],"z":[[0,0,0,1.3876008168951022,6.1853940015168929,0.11454433336142404,0,0,0],[0,0,0.016143832218724188,2.0225915508315864,5.1575700169247867,0.48892749005278985,0.0023062617455320276,0,0],[0,0,0.097631747227522478,2.2324613696750006,4.5310355760552534,0.81411039617280578,0.012300062642837482,0,0],[0,0.0023062617455320259,0.19372598662469026,2.3969747075229519,4.0413393320872864,1.0132176602037375,0.03920644967404447,0.00076875391517734119,0],[0,0.01230006264283747,0.29597025734327681,2.4446374502639472,3.6592686362441476,1.1861872911186395,0.087637946330217056,0.0015375078303546824,0],[0.0015375078303546846,0.023831371370497598,0.45125854820909994,2.38313713704976,3.3694484102222897,1.3253317497657386,0.12684439600426153,0.0061500313214187296,0],[0.00076875391517734228,0.042281465334753805,0.56195911199463722,2.343161933460538,3.1903287479859688,1.3453193515603494,0.18450093964256223,0.01921884787943353,0],[0.0023062617455320267,0.066881590620428741,0.66343462879804638,2.2755115889249322,2.9950652535309241,1.4229634969932612,0.2421574832808629,0.01921884787943353,0],[0.0046125234910640535,0.09071296199092635,0.7572226064496822,2.2186237992018087,2.8589958105445343,1.4237322509084385,0.29904527300398626,0.033056418352625676,0.0015375078303546852],[0.0099938008973054493,0.11685059510695597,0.83025422839152963,2.1932549200009563,2.6983262422724699,1.4421823448726947,0.34517050791462683,0.049200250571349836,0.0023062617455320276],[0.013068816558014819,0.15682579869617774,0.88329824853876626,2.1463609311751384,2.533812904424519,1.4806200406315617,0.41051459070470092,0.060731559299009953,0.0023062617455320276],[0.016912586133901529,0.20833231101305966,0.90559211207890922,2.1163795284832223,2.4146560475720307,1.4852325641226258,0.46355861085193756,0.071494114111492729,0.0053812774062413976]],"type":"surface","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-f734802c7596cf4923cf" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-f734802c7596cf4923cf">{"x":{"visdat":{"359a7ab55361":["function () ","plotlyVisDat"]},"cur_data":"359a7ab55361","attrs":{"359a7ab55361":{"y":[1,2,3,4,5,6,7,8,9,10,11,12],"x":[0.066641168952025459,0.20962869856918151,0.35261622818633753,0.49560375780349364,0.63859128742064974,0.78157881703780574,0.92456634665496185,1.0675538762721177,1.2105414058892738],"z":[[0,0,0,0.011889148686963736,5.1452039347054246,1.8358244296046962,0.00069936168746845566,0,0],[0,0,0,0.1230876569944481,4.5283669263582471,2.3330705893947683,0.0090917019370899237,0,0],[0,0,0.00069936168746845544,0.26575744123801293,4.1248352326889481,2.5477746274475841,0.054550211622539542,0,0],[0,0,0.0055948934997476435,0.44689211829234282,3.7730563038923153,2.6205082429443034,0.14686595436837568,0.00069936168746845566,0],[0,0,0.013287872061900654,0.62452998690933037,3.4779256717806271,2.641489093568357,0.23498552698940112,0.0013987233749369113,0],[0,0,0.024477659061395939,0.74691828221631007,3.2632216337278117,2.5918344137580966,0.36156999242119159,0.0055948934997476453,0],[0,0.0013987233749369109,0.050354041497728791,0.85811679052379441,3.0408246171128428,2.54497718069771,0.48046147929082905,0.017484042186711391,0],[0,0.0013987233749369109,0.082524679121277741,0.89448359827215407,2.8932593010569989,2.491126330762639,0.59445743434818732,0.036366807748359695,0],[0,0.0055948934997476435,0.10630297649520523,0.98470125595558478,2.7428965382512809,2.4106997367037666,0.68747253878149195,0.055249573310007995,0.00069936168746845512],[0,0.0090917019370899202,0.15735637968040248,0.98609997933052174,2.6358942000686074,2.3568488867686956,0.75670934584086902,0.087420210933556952,0.0041961701248107303],[0.00069936168746845544,0.01818340387417984,0.19092574067888834,1.0084795533295123,2.5086103729493483,2.3204820790203358,0.81685445096315623,0.12238829530697974,0.0069936168746845507],[0.0013987233749369109,0.024477659061395939,0.21959956986509502,1.0490425312026828,2.4120984600787017,2.2274669745870312,0.88748998139747026,0.16295127318015018,0.0090917019370899167]],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface","colors":["#05386B","magenta2","#EDF5E1"],"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"AUD/USD"},"yaxis":{"title":"h-step forecast"},"zaxis":{"title":"density"}},"title":"AUD/USD forecast densities for extended model","hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"colorbar":{"title":"","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(5,56,107,1)"],["0.0416666666666667","rgba(40,58,117,1)"],["0.0833333333333333","rgba(62,60,127,1)"],["0.125","rgba(81,61,138,1)"],["0.166666666666667","rgba(99,62,148,1)"],["0.208333333333333","rgba(116,61,159,1)"],["0.25","rgba(134,60,170,1)"],["0.291666666666667","rgba(151,58,181,1)"],["0.333333333333333","rgba(168,55,192,1)"],["0.375","rgba(185,49,203,1)"],["0.416666666666667","rgba(203,42,215,1)"],["0.458333333333333","rgba(220,29,226,1)"],["0.5","rgba(238,0,238,1)"],["0.541666666666667","rgba(240,59,237,1)"],["0.583333333333333","rgba(242,85,237,1)"],["0.625","rgba(243,106,236,1)"],["0.666666666666667","rgba(244,125,235,1)"],["0.708333333333333","rgba(245,142,234,1)"],["0.75","rgba(245,158,233,1)"],["0.791666666666667","rgba(245,173,232,1)"],["0.833333333333333","rgba(245,188,231,1)"],["0.875","rgba(243,203,230,1)"],["0.916666666666667","rgba(242,217,228,1)"],["0.958333333333333","rgba(240,231,227,1)"],["1","rgba(237,245,225,1)"]],"showscale":true,"y":[1,2,3,4,5,6,7,8,9,10,11,12],"x":[0.066641168952025459,0.20962869856918151,0.35261622818633753,0.49560375780349364,0.63859128742064974,0.78157881703780574,0.92456634665496185,1.0675538762721177,1.2105414058892738],"z":[[0,0,0,0.011889148686963736,5.1452039347054246,1.8358244296046962,0.00069936168746845566,0,0],[0,0,0,0.1230876569944481,4.5283669263582471,2.3330705893947683,0.0090917019370899237,0,0],[0,0,0.00069936168746845544,0.26575744123801293,4.1248352326889481,2.5477746274475841,0.054550211622539542,0,0],[0,0,0.0055948934997476435,0.44689211829234282,3.7730563038923153,2.6205082429443034,0.14686595436837568,0.00069936168746845566,0],[0,0,0.013287872061900654,0.62452998690933037,3.4779256717806271,2.641489093568357,0.23498552698940112,0.0013987233749369113,0],[0,0,0.024477659061395939,0.74691828221631007,3.2632216337278117,2.5918344137580966,0.36156999242119159,0.0055948934997476453,0],[0,0.0013987233749369109,0.050354041497728791,0.85811679052379441,3.0408246171128428,2.54497718069771,0.48046147929082905,0.017484042186711391,0],[0,0.0013987233749369109,0.082524679121277741,0.89448359827215407,2.8932593010569989,2.491126330762639,0.59445743434818732,0.036366807748359695,0],[0,0.0055948934997476435,0.10630297649520523,0.98470125595558478,2.7428965382512809,2.4106997367037666,0.68747253878149195,0.055249573310007995,0.00069936168746845512],[0,0.0090917019370899202,0.15735637968040248,0.98609997933052174,2.6358942000686074,2.3568488867686956,0.75670934584086902,0.087420210933556952,0.0041961701248107303],[0.00069936168746845544,0.01818340387417984,0.19092574067888834,1.0084795533295123,2.5086103729493483,2.3204820790203358,0.81685445096315623,0.12238829530697974,0.0069936168746845507],[0.0013987233749369109,0.024477659061395939,0.21959956986509502,1.0490425312026828,2.4120984600787017,2.2274669745870312,0.88748998139747026,0.16295127318015018,0.0090917019370899167]],"type":"surface","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>The 3D plots above allow us to access to alternative vantage points. We could notice that for the first few forecasting periods, the extended model has very sharp and concentrated densities around the point estimated, and it shows clearly heavy tails, which may increase the possibility of capturing extreme values that deviate significantly from the central forecast.</p>
</section>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>In this research project, we use one basic and two extended Bayesian models to forecast the AUD/USD exchange rate, with the extension model with heteroskedasticity as a remaining topic to do further forecasting. For the basic model, we use Minnesota before fitting our non-stationary data property. Then we applied the Laplace distribution to the error term to capture the leptokurtotic and anomies of the financial data. We also introduced the stochastic volatility model to further capture the volatility of the error term.</p>
<p>We do the forecasting in h=12 steps which is 3 years in our case and for the point estimate of the forecasting, among different models, the basic model forecasting shows a slightly decreasing trend, while the extended and the basic model with heteroskedasticity has an opposite trend and shows a increasing trend among forecasting periods.</p>
<p>In conclusion, compared to the basic model, both extension models increase the estimation of the forecasting in different ways and provide more informative forecasting of the AUD/USD exchange rate.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>