[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Exchange Rate Forecasting Using Bayesian VARs Model",
    "section": "",
    "text": "Abstract. This research report explores how Bayesian VARs model predict AUD/USD exchange rate. Keywords. Bayesian Vars, Exchange rate, Forecasting, Minnesota Prior, Laplace distribution"
  },
  {
    "objectID": "index.html#the-basic-model",
    "href": "index.html#the-basic-model",
    "title": "Exchange Rate Forecasting Using Bayesian VARs Model",
    "section": "The basic model",
    "text": "The basic model\n\\[\\begin{align}\nY &=XA+U\\\\\nU|X&\\sim \\mathcal{MN}_{T\\times N}(0, \\Sigma, I_T)\\\\\nY|X,A,\\Sigma&\\sim \\mathcal{MN}_{T\\times N} (XA, \\Sigma, I_T)\n\\end{align}\\]\nWhere \\(Y\\) is a \\(T\\times 13\\) Matrix, \\(X\\) is a \\(T\\times(1+p\\times13)\\), \\(A\\) is a \\((1+p\\times13)\\times13\\) matrix that contains \\(\\mu_{0}\\) and vectors of the autoregressive slope parameters and \\(U\\) is a \\(T\\times13\\) matrix contains vetors of error terms.\nThe kernel of the likelihood function:\n\\[\\begin{align}\nL(A,\\Sigma|Y,X) \\propto det(\\Sigma)^{-\\frac{T}{2}}exp\\{-\\frac{1}{2}tr[\\Sigma^{-1}(Y-XA)'(Y-XA)]\\}\n\\end{align}\\]\nThe basic model is based on Natural-conjugate prior distribution, where the \\(A\\) follows a Matrix-variate Normal distribution and \\(\\Sigma\\) follows an Inverse Wishart distribution.\n\\[\\begin{align}\np(A,\\Sigma) &= p(A|\\Sigma)p(\\Sigma) \\\\\nA|\\Sigma &\\sim \\mathcal{MN}_{K \\times N}(\\underline{A},\\Sigma,\\underline{V}) \\\\\n\\Sigma &\\sim \\mathcal{IW}_N(\\underline{S},\\underline{\\nu})\n\\end{align}\\]\nThe Minnesota prior is typically a good choice for specifying priors in BVAR model especially when the model involves many macroeconomic variables. It assumes the variables follow a random walk and it is suitable for unit root non-stationary variables such as in our case, variables are integrated at 1 at the 5% significance level of the ADF test, where:\n\\[\\begin{align}\n\\underline{A} &= \\begin{bmatrix}0_{N \\times 1} & I_{N} & 0_{N \\times (p-1)N}\\end{bmatrix}'\\\\\n\n\\underline{V} &= diag( \\begin{bmatrix} \\kappa_2 & \\kappa_1(p^{-2}\\otimes I_N') \\end{bmatrix})\n\n\\end{align}\\]\nThe prior mean \\(\\underline{A}\\) for the first lag of each variable (the identity matrix portion) is one, while all other coefficients including intercepts, are zeroes. For the column-specific prior covariance \\(\\underline{V}\\), two shrinkage hyper-parameters \\(\\kappa_1\\) and \\(\\kappa_2\\) represent the overall shrinkage level for slopes and constant terms respectively.\nFor posterior distribution, the kernel of the posterior distribution takes the form of the product of the likelihood and the prior distributions.\n\\[\\begin{align*}\np(A,\\Sigma|Y,X) &\\propto L(A,\\Sigma|Y,X)p(A,\\Sigma) \\\\\n&= L(A,\\Sigma|Y,X)p(A|\\Sigma)p(\\Sigma)\n\\end{align*}\\]\n\\[\\begin{align}\np(A,\\Sigma|Y,X) &\\propto \\det(\\Sigma)^{-\\frac{T}{2}} \\\\\n&\\times exp\\{-\\frac{1}{2}tr[\\Sigma^{-1}(Y-XA)'(Y-XA)]\\} \\\\\n&\\times \\det(\\Sigma)^{-\\frac{N+K+\\underline{v}+1}{2}} \\\\\n&\\times exp\\{-\\frac{1}{2}tr[\\Sigma^{-1}(A-\\underline{A}) \\underline{V}^{-1}(A-\\underline{A})]\\} \\\\\n&\\times exp\\{-\\frac{1}{2}tr[\\Sigma^{-1}\\underline{S}]\\}\n\\end{align}\\]\nThe kernel can be represent as the normal-inverse Wishart distribution and we can get the following full conditional joint posterior distribution:\n\\[\\begin{align}\np(A|Y,X,\\Sigma) &= \\mathcal{MN}_{K \\times N}(\\bar{A}, \\Sigma, \\bar{V}) \\\\\np(\\Sigma|Y,X) &= \\mathcal{IW}_N(\\bar{S},\\bar{\\nu}) \\\\\n\\\\\n\\bar{V} &= (X'X + \\underline{V}^{-1})^{-1} \\\\\n\\bar{A} &= \\bar{V}(X'Y + \\underline{V}^{-1}\\underline{A}) \\\\\n\\bar{\\nu} &= T + \\underline{\\nu} \\\\\n\\bar{S} &= \\underline{S} + Y'Y + \\underline{A}'\\underline{V}^{-1}\\underline{A} - \\bar{A}'\\bar{V}^{-1}\\bar{A} \\\\\n\n\\end{align}\\]\n\n########################## basic model code \n## Posterior sample draw\nposterior.draws       = function (S, Y, X, A.prior, V.prior, S.prior, nu.prior){\n  \n    # normal-inverse Wishard posterior parameters\n    V.bar.inv         = t(X)%*%X + diag(1/diag(V.prior))\n    V.bar             = solve(V.bar.inv)\n    A.bar             = V.bar%*%(t(X)%*%Y + diag(1/diag(V.prior))%*%A.prior)\n    nu.bar            = nrow(Y) + nu.prior\n    S.bar             = S.prior + t(Y)%*%Y + t(A.prior)%*%diag(1/diag(V.prior))%*%A.prior - t(A.bar)%*%V.bar.inv%*%A.bar\n    S.bar.inv         = solve(S.bar)\n  \n    # posterior draws \n    Sigma.posterior   = rWishart(S, df=nu.bar, Sigma=S.bar.inv)\n    Sigma.posterior   = apply(Sigma.posterior,3,solve)\n    Sigma.posterior   = array(Sigma.posterior,c(N,N,S))\n    A.posterior       = array(rnorm(prod(c(dim(A.bar),S))),c(dim(A.bar),S))\n    L                 = t(chol(V.bar))\n    for (s in 1:S){\n      A.posterior[,,s]= A.bar + L%*%A.posterior[,,s]%*%chol(Sigma.posterior[,,s])\n    }\n \n    output            = list(A.posterior=A.posterior, Sigma.posterior=Sigma.posterior)\n    return(output)\n}\n\n\nEstimation Outcomes on Basic Model\n\nhead(round(apply(posterior.sample.draws$A.posterior, 1:2, mean),6))         # posterior draw A\n\n          [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]\n[1,]  0.000059  4.392627  4.378695  4.318534  3.112916  9.391475  7.132752\n[2,]  0.999963  0.000269  0.000219  0.001834 -0.002820  0.000639  0.000834\n[3,]  0.000002  0.001848  0.001678 -0.011600 -0.009140  0.004496  0.003641\n[4,] -0.000030  0.001743  0.001599 -0.010009 -0.007712  0.004351  0.003495\n[5,] -0.000022 -0.012155 -0.011054  0.165295  0.089789 -0.029951 -0.023588\n[6,] -0.000220 -0.009505 -0.008065  0.097097  0.164386 -0.023265 -0.018084\n          [,8]      [,9]     [,10]     [,11]     [,12]     [,13]\n[1,]  9.350008  7.398900 12.774987  9.591428  6.398212  5.058243\n[2,]  0.000699  0.000708  0.000293  0.000161 -0.001682  0.004085\n[3,]  0.005130  0.003820  0.002282  0.001757 -0.010652 -0.001399\n[4,]  0.004897  0.003737  0.002191  0.001702 -0.011251 -0.001923\n[5,] -0.034214 -0.024050 -0.014877 -0.011495  0.047403  0.025955\n[6,] -0.024253 -0.019813 -0.011394 -0.008092  0.045546 -0.061624\n\nhead(round(apply(posterior.sample.draws$Sigma.posterior, 1:2, mean),6))     # posterior draw sigma\n\n          [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]\n[1,]  0.001747 -0.000231 -0.000211  0.003646 -0.003595 -0.001070 -0.001400\n[2,] -0.000231  0.035757  0.032414 -0.220595 -0.172679  0.086973  0.070738\n[3,] -0.000211  0.032414  0.029752 -0.197326 -0.144079  0.080007  0.064462\n[4,]  0.003646 -0.220595 -0.197326  3.155867  1.821344 -0.534370 -0.425034\n[5,] -0.003595 -0.172679 -0.144079  1.821344  3.454625 -0.425686 -0.330479\n[6,] -0.001070  0.086973  0.080007 -0.534370 -0.425686  0.222121  0.177485\n          [,8]      [,9]     [,10]     [,11]     [,12]     [,13]\n[1,] -0.002148 -0.000876 -0.000230 -0.000166 -0.001206  0.011349\n[2,]  0.098956  0.074169  0.044397  0.034177 -0.206940 -0.034877\n[3,]  0.090641  0.068504  0.040728  0.031601 -0.198525 -0.039418\n[4,] -0.622403 -0.422772 -0.267864 -0.204680  0.722705  0.330735\n[5,] -0.440899 -0.361154 -0.208957 -0.147903  0.823135 -1.288953\n[6,]  0.244858  0.192238  0.109810  0.085626 -0.587810 -0.104552\n\n\n\npar(mfrow=c(2,2), mar=c(4,4,2,2))\n\nplot.ts(posterior.sample.draws$A.posterior[2,1,], xlab = \"Simulation times S\", ylab = \"AUD/USD exchange rate\", col = mcxs1)\nhist(posterior.sample.draws$A.posterior[2,1,], xlab = \"AUD/USD exchange rate\", col = mcxs1, main = '')\n\nplot.ts(posterior.sample.draws$Sigma.posterior[1,1,], xlab = \"Simulation times S\", ylab = \"AUD/USD exchange rate sigma\", col = mcxs2)\nhist(posterior.sample.draws$Sigma.posterior[1,1,], xlab = \"AUD/USD exchange rate sigma\", col = mcxs2, main = '')\n\n\n\n\nThe trace plots and the histogram plot of posterior draws of\\(A\\) and \\(\\Sigma\\) is presented above with the trace plots shows significant volatility."
  },
  {
    "objectID": "index.html#the-extended-model",
    "href": "index.html#the-extended-model",
    "title": "Exchange Rate Forecasting Using Bayesian VARs Model",
    "section": "The Extended Model",
    "text": "The Extended Model\nThe extended model will be built based on the the change in distribution of the error to Laplace distribution instead of the normally distributed errors assumption. The Laplace distribution is suitable for describing financial anomalies due to its sharp peaks and thick tails and the use of this distribution improves the robustness of the model to anomalies and is particularly suitable for financial time series. As our variables are most financial time series data, a Laplace distribution is more suitable to apply to our error term.\nFollowing Eltoft,Kim, and Lee 2006b, for covariance with a general Kronecker structure, if each \\({\\lambda_t}\\) has an independent exponential distribution with mean \\({\\alpha}\\), then marginally \\({U_t}\\) has a multivariate Laplace distribution with mean vector 0 and covariance matrix \\({\\alpha\\Sigma}\\).\n\\[\\begin{align}\n\nvec(U)&\\sim N(0,\\Sigma\\otimes \\Omega)\\\\\n\nU_t &\\sim \\text{Laplace}(0, \\alpha\\Sigma) \\\\\n\nU_t | \\lambda_t &\\sim \\mathcal{MN}(0, \\Sigma, \\Omega) \\\\\n\n\\lambda_t &\\sim \\text{Exponential}(\\frac{1}{\\alpha})\n\\end{align}\\]\nThe model is where \\[\\Omega=diag(\\lambda_1,\\lambda_2,...,\\lambda_t)\\], each lambda independently drawn from an exponential distribution.\nThe kernel of the likelihood function now is :\n\\[\\begin{align}\nL(A,\\Sigma,\\Omega |Y,X) &\\propto \\det(\\Sigma)^{-\\frac{T}{2}} \\det(\\Omega)^{-\\frac{N}{2}} exp\\{-\\frac{1}{2} tr[\\Sigma^{-1} (Y-XA)' \\Omega^{-1} (Y-XA) ]\\}\\\\\n&=\\det(\\Sigma)^{-\\frac{T}{2}}\\prod^{T}_{t = 1} \\lambda_t^{-\\frac{N}{2}} exp({-\\frac{1}{2}}\\sum^{T}_{t =1}{\\frac{1}{\\lambda_t}} \\epsilon_t' \\Sigma^{-1}\\epsilon_t)\\\\\n&=\\det(\\Sigma)^{-\\frac{T}{2}}\\prod^{T}_{t = 1}( \\lambda_t^{-\\frac{N}{2}} exp({-\\frac{1}{2}}{\\frac{1}{\\lambda_t}} \\epsilon_t' \\Sigma^{-1}\\epsilon_t))\n\\end{align}\\]\nThence, for each time t, we have the likelihood like:\n\\[\\begin{align}\n&=\\lambda_t^{-\\frac{N}{2}} exp({-\\frac{1}{2}}{\\frac{1}{\\lambda_t}} \\epsilon_t' \\Sigma^{-1}\\epsilon_t)\n\\end{align}\\]\nFor posteriors distribution, \\(A\\), \\(\\Sigma\\) and \\(\\lambda_t\\) can then be derived using the likelihood and the prior distributions as follows:\n\\[\\begin{align}\np(A,\\Sigma|Y,X) &\\propto L(A,\\Sigma,\\lambda_t|Y,X)p(A,\\Sigma) \\\\\n\\\\\n&= \\det(\\Sigma)^{-\\frac{T}{2}} \\det(\\Omega)^{-\\frac{N}{2}} exp\\{-\\frac{1}{2} tr[\\Sigma^{-1} (Y-XA)' \\Omega^{-1} (Y-XA) ]\\} \\\\\n&\\times \\det(\\Sigma)^{-\\frac{N+k+\\underline{\\nu}+1}{2}} exp\\{-\\frac{1}{2}tr[\\Sigma^{-1}(A-\\underline{A})'(\\underline{V})^{-1}(A-\\underline{A})]\\} \\\\\n&\\times exp\\{-\\frac{1}{2}tr[\\Sigma^{-1}\\underline{S}]\\} \\\\\n&= \\det(\\Sigma)^{-\\frac{T+N+K+\\underline{\\nu}+1}{2}} \\det(\\Omega)^{-\\frac{N}{2}} \\\\\n&\\times exp\\{-\\frac{1}{2} tr[\\Sigma^{-1}(Y'\\Omega^{-1}Y - 2A'X'\\Omega)^{-1}Y + A'X'\\Omega^{-1}XA \\\\\n&+ A'\\underline{V}^{-1}A -2A'\\underline{V}^{-1}\\underline{A} + \\underline{A}'\\underline{V}^{-1}\\underline{A} + \\underline{S})]\\}\n\n\\end{align}\\]\nThe kernel can be rearranged in the form of the Matrix-variate normal-inverse Wishart distribution.\n\\[\\begin{align}\np(A,\\Sigma|Y,X) &\\sim MNIW(\\bar{A},\\bar{V},\\bar{S},\\bar{\\nu}) \\\\\n&\\\\\n\\bar{V} &= (X'\\Omega^{-1}X + \\underline{V}^{-1})^{-1} \\\\\n\\bar{A} &= \\bar{V}(X'\\Omega^{-1}Y + \\underline{V}^{-1}\\underline{A}) \\\\\n\\bar{\\nu} &= T + \\underline{\\nu}\\\\\n\\bar{S} &= Y'\\Omega^{-1}Y + \\underline{A}'\\underline{V}^{-1}\\underline{A} + \\underline{S} - \\bar{A}'\\bar{V}^{-1}\\bar{A}\n\\end{align}\\]\nThe prior distribution of \\[\\lambda_t \\sim \\text{Exponential}(\\frac{1}{\\alpha})\\] define as:\n\\[\\begin{align}\np(\\lambda_t|\\alpha) &= \\frac{1}{\\alpha}exp\\{ -\\frac{1}{\\alpha}\\lambda_t \\}\\\\\n\n\\end{align} \\]\nThe kernel of the fully conditional posterior distribution of \\(\\lambda_t\\) is then derived as follows:\n\\[\\begin{align}\np(\\lambda_t|Y,X,A,\\Sigma) &\\propto L(A,\\Sigma,\\lambda_t|Y,X)p(\\lambda_t) \\\\\n\\\\\n&\\propto \\lambda_t^{-\\frac{N}{2}}exp({-\\frac{1}{2}}{\\frac{1}{\\lambda_t}}\\epsilon_t' \\Sigma^{-1}\\epsilon_t) \\\\\n&\\times \\frac{1}{\\alpha}exp\\{ -\\frac{1}{\\alpha}\\lambda_t \\}\\\\\n\n\n&= \\lambda_t^{-\\frac{N}{2}+1-1} exp\\{-\\frac{1}{2}[\\frac{\n\\epsilon_t' \\Sigma^{-1}\\epsilon_t} {\\lambda_t} +\\frac{2}{\\alpha}\\lambda_t]\\}\n\\end{align}\\]\nThe above expression can be rearranged in the form of a Generalized inverse Gaussian distribution kernel as follows:\n\\[\\begin{align}\n\\lambda_t|Y,A,\\Sigma &\\sim GIG(a,b,p) \\\\\n\\\\\na &=\\frac{2}{\\alpha} \\\\\nb &= \\epsilon_t' \\Sigma^{-1}\\epsilon_t \\\\\np &= -\\frac{N}{2}+1\n\\end{align}\\]\nThe Gibbs sampler method will be applied to generate random draws from the full conditional posterior distribution:\n\nDraw \\(\\Sigma^{(s)}\\) from the \\(IW(\\bar{S},\\bar{\\nu})\\) distribution.\nDraw \\(A^{(s)}\\) from the \\(MN(\\bar{A},\\Sigma^{(s)}, \\bar{V})\\) distribution.\nDraw \\(\\lambda_t^{(s)}\\) from \\(GIG(a,b,p)\\).\n\nRepeat steps 1, step 2 and 3 for \\(S_1\\)+\\(S_2\\)times.\nDiscard the first draws that allowed the algorithm to converge to the stationary posterior distribution.\nOutput is \\(\\left\\{ {A^{(s)}, \\Sigma^{(s)}}, \\lambda_t^{(s)}\\right\\}^{S_1+S_2}_{s=S_1+1}\\).\n\nposterior.draws.extended &lt;- function(S1,total_S,Y, X, A.prior, V.prior, S.prior, nu.prior, lambda.priors){\n\n  Sigma.posterior.draws = array(NA, c(N,N,total_S))\n  A.posterior.draws = array(NA, c((1+p*N),N,total_S))\n  lambda.posterior.draws = array(NA,c(T,total_S+1))\n\n  for (s in 1:total_S){\n    \n    if (s == 1) {\n      lambda.s = lambda.0\n    } else {\n      lambda.s    = lambda.posterior.draws[,s]\n    }\n    \n    Omega = (diag(lambda.s))\n    Omega.inv = diag(1/lambda.s)\n\n    V.bar.inv.ext   = t(X)%*%Omega.inv%*%X + V.prior.inv\n    V.bar.inv.ext   = 0.5 * (t(V.bar.inv.ext) + V.bar.inv.ext)\n    V.bar.ext       = solve(V.bar.inv.ext)\n    V.bar.ext       = 0.5 * (t(V.bar.ext) + V.bar.ext)\n    A.bar.ext       = V.bar.ext%*%(t(X)%*%Omega.inv%*%Y + V.prior.inv%*%A.prior)\n    nu.bar.ext      = T + nu.prior\n    S.bar.ext       = S.prior + t(Y)%*%Omega.inv%*%Y + t(A.prior)%*%V.prior.inv%*%A.prior - t(A.bar.ext)%*%V.bar.inv.ext%*%A.bar.ext\n    S.bar.ext       = 0.5 * (t(S.bar.ext) + S.bar.ext)\n    S.bar.ext.inv   = solve(S.bar.ext)\n    S.bar.ext.inv   = 0.5 * (t(S.bar.ext.inv) + S.bar.ext.inv)\n    \n    Sigma.inv.draw = rWishart(1, df = nu.bar.ext, Sigma = S.bar.ext.inv)[,,1]\n    Sigma.posterior.draws[,,s] = solve(Sigma.inv.draw)\n    A.posterior.draws[,,s] = matrix(mvtnorm::rmvnorm(1, mean=as.vector(A.bar.ext), sigma = Sigma.posterior.draws[,,s] %x% V.bar.ext), ncol=N)\n    \n    \n    u.t = Y-X%*%A.posterior.draws[,,s]\n    #    ---- loop lambda posterior ----   #\n    c                      = -N/2 + 1          # N=13\n    a                      = 2 / lambda.priors$alpha\n    for (x in 1:T){\n      b                  = t((u.t)[x,])%*% Sigma.inv.draw %*%(u.t)[x,]\n      lambda.posterior.draws[x,s+1] = GIGrvg::rgig(1, lambda = c, chi = b, psi = a)\n    } # END x loop\n  } # END s loop\n  \n  \n  output                 = (list(A.posterior.exten = A.posterior.draws[,,S1:total_S], \n                                 Sigma.posterior.exten = Sigma.posterior.draws[,,S1:total_S], \n                                 lambda.posterior.exten = lambda.posterior.draws[,(S1+1):(total_S+1)]))\n  \n}\n\n\nEstimation Outcomes on Extended Model\n\n\n          [,1]      [,2]      [,3]      [,4]     [,5]      [,6]      [,7]\n[1,]  0.053895  0.002288 -0.006514  2.317809 1.084531 -0.029302 -0.033987\n[2,]  0.966115 -0.000186  0.003070  0.034186 0.269116  0.023185  0.030331\n[3,]  0.001977  0.999375  0.001663 -0.037328 0.022723  0.007156  0.009715\n[4,] -0.004543  0.000732  1.000200  0.026527 0.120949  0.010594  0.007228\n[5,] -0.006454  0.003007  0.000810  1.041637 0.436674  0.004589  0.003559\n[6,]  0.001694 -0.000022 -0.001236  0.091633 0.914949  0.004972  0.006985\n          [,8]     [,9]     [,10]     [,11]     [,12]     [,13]\n[1,] -0.196590 0.067950  0.018445  0.007454 -0.408787  0.245716\n[2,]  0.064429 0.024355  0.001374  0.001106 -0.022734 -0.104245\n[3,]  0.026864 0.006673 -0.000599  0.000997  0.036264 -0.024756\n[4,]  0.023646 0.007703  0.000250  0.001194 -0.009401 -0.035531\n[5,]  0.011355 0.003308 -0.002759 -0.001262 -0.047686  0.021475\n[6,]  0.002964 0.004346  0.000525  0.001722 -0.023745 -0.050207\n\n\n          [,1]     [,2]     [,3]      [,4]      [,5]      [,6]     [,7]\n[1,]  0.000997 0.000000 0.000019  0.001402 -0.000324 -0.000326 0.000125\n[2,]  0.000000 0.000012 0.000007  0.000115  0.000063  0.000007 0.000019\n[3,]  0.000019 0.000007 0.000040  0.000187  0.000807  0.000039 0.000041\n[4,]  0.001402 0.000115 0.000187  0.060030  0.016529 -0.000299 0.000935\n[5,] -0.000324 0.000063 0.000807  0.016529  0.268300  0.001330 0.001038\n[6,] -0.000326 0.000007 0.000039 -0.000299  0.001330  0.001329 0.000146\n          [,8]     [,9]    [,10]     [,11]     [,12]     [,13]\n[1,] -0.000852 0.000085  1.4e-05  0.000025 -0.001019  0.000321\n[2,]  0.000034 0.000016  0.0e+00 -0.000001 -0.000062 -0.000084\n[3,]  0.000051 0.000038  1.0e-06  0.000002 -0.000043 -0.000162\n[4,] -0.002035 0.001126  1.2e-04  0.000080 -0.002775 -0.007521\n[5,]  0.001359 0.001533 -8.8e-05  0.000162 -0.003860 -0.024361\n[6,]  0.000879 0.000152  1.5e-05  0.000019 -0.000550 -0.001346\n\n\n[1] 1.898383\n\n\n\n\n\n\n\nCompared to the basic model, by applying laplace distribution into the variance specification of the error term, we introduces more variability to our \\(A\\) and \\(\\Sigma\\), in which both fluctuates more.That is, the coefficient of the exchange rate now range from 0.85 to 1.05, which is broader than 0.90 to 1.05 as in the basic model.\nThe lambda mainly concentrates between 0 to 4, with some large outlines throughout the simulation."
  },
  {
    "objectID": "index.html#proof-of-model-validity",
    "href": "index.html#proof-of-model-validity",
    "title": "Exchange Rate Forecasting Using Bayesian VARs Model",
    "section": "Proof of Model Validity",
    "text": "Proof of Model Validity\n\nProof of Basic Model Validity\nTo test the model validity, we simulated 1000 observations from a bi-variate Gaussian random walk process with the covariance matrix equal to the identity matrix of order 2 to see how the autoregressive and the covariance matrices and the posterior mean of the constant term behave.\n\n\n\n\n\n\n\n\nPosterior mean of the covariance matrix Sigma\n\n\n\nSimulation_Y1\nSimulation_Y2\n\n\n\n\nY1-Lag\n0.9792907\n0.0879718\n\n\nY2-Lag\n0.0879718\n1.0175614\n\n\n\n\n\n\n\n\nPosterior mean of the autoregressive coefficient matrix A\n\n\n\nSimulation_Y1\nSimulation_Y2\n\n\n\n\nConstant\n0.0613107\n0.0816854\n\n\nY1-Lag\n0.9887103\n0.0051631\n\n\nY2-Lag\n0.0025990\n0.9954842\n\n\n\n\n\nThe diagonal entries of the covariance matrix are close to 1, which indicates that each variable has a strong autoregressive relationship with itself and similarly, the diagonal elements of the autoregressive coefficient matrix are close to one, suggesting that each variable is heavily influenced by its past value. Besides, the posterior means for the constant terms is close to 0, the above can indicate that the estimated parameter constant term and means are consistent with what we expect given a Minnesota prior.\n\n\nProof of Extended Model\n\n\n\nPosterior mean of the covariance matrix Sigma\n\n\n\nSimulation_Y1\nSimulation_Y2\n\n\n\n\nY1-Lag\n1.2315213\n0.1088601\n\n\nY2-Lag\n0.1088601\n1.3150093\n\n\n\n\n\n\n\n\nPosterior mean of the autoregressive coefficient matrix A\n\n\n\nSimulation_Y1\nSimulation_Y2\n\n\n\n\nConstant\n0.0569282\n0.1098639\n\n\nY1-Lag\n0.9901086\n0.0101672\n\n\nY2-Lag\n0.0028611\n0.9930109\n\n\n\n\n\nSimilarly, the posterior mean of the autoregressive and the covariance matrices are close to an identity matrix and the posterior mean of the constant term is close to zero, so we can conclude that the extended model is also valid."
  },
  {
    "objectID": "index.html#forecasting-with-basic-model",
    "href": "index.html#forecasting-with-basic-model",
    "title": "Exchange Rate Forecasting Using Bayesian VARs Model",
    "section": "Forecasting with basic model",
    "text": "Forecasting with basic model\n\n\n\n\n\n\n90%, 68% and 15% highest density intervals respectively\n\n\n\n\n\nThe above presents the historical and forecasting data the AUD/USD exchange rate for baisc and extended model.\nFor the point forecast, for basic model, the exchange rate shows several peaks and troughs, indicating the volatility in the exchange rate over the years. For the three years forecasting, it shows a clear downward trend and reaching the lowest above 0.6 in 2026. And for extended model, it also shows a clear downward trend for the first half forecasting period and reaching below 0.06 in around 2025 and slightly increase back to 0.61 fo the following period.\nRegard to the 3D with density intervals below for both model forecasting, we could notice that the for each different predictive density at specific horizons, with the back wall we have the one period ahead predictive density and with the front we have the 12 period ahead density which is 3 years. We could see the distribution becomes lower and more dispersed with the increases of the horizon, as the data is more informative about the nearest developments in the future. Hence, one period predictive density is highly concentrated relative to others with smaller variance and taller peak. Similarly, the interval become more wider and dispersed resulting a more uncertainty for the future period forecasting.\n\n\n\n\n\nInteractive versions of the above 3D plots are provided below.\n\n\n\n\n\n\n\n\n\n\nThe 3D plots above allow us to access to alternative vantage points. We could notice that for the first few forecasting periods, the extended model has very sharp and concentrated densities around the point estimated, and it shows clearly heavy tails, which may increase the possibility of capturing extreme values that deviate significantly from the central forecast."
  },
  {
    "objectID": "Test.html",
    "href": "Test.html",
    "title": "test",
    "section": "",
    "text": "# log transformation of data\ncpi_au &lt;- log(cpi_au)\ncpi_us &lt;- log(cpi_us)\nrgdp_au &lt;- log(rgdp_au)\nrgdp_us &lt;- log(rgdp_us)\nimpor_au &lt;- log(impor_au)\nimpor_us&lt;- log(impor_us)\nexpor_au &lt;- log(expor_au)\nexpor_us&lt;- log(expor_us)\ngprice &lt;- log(gprice)\n\n\n\n\n\n\n\n\n\n\nx_varibales &lt;-  na.omit(merge(gprice,\n                            cpi_au, cpi_us, \n                            crate_au, crate_us, \n                            expor_au, expor_us,  \n                            impor_au, impor_us, \n                            rgdp_au, rgdp_us,\n                            unemr_au, unemr_us))\ncolnames(x_varibales)   = c(\"gold price\", \n                         \"cpi_au\",    \"cpi_us\", \n                         \"cashrate_au\",  \"cashrate_us\", \n                         \"export_au\", \"export_us\",\n                         \"import_au\",   \"import_us\",\n                         \"realgdp_au\", \"realgdp_us\",\n                         \"unemployemtrate_au\", \"unemployemtrate_us\")\n\n\n# Compute correlation matrix\ncorrelation_matrix &lt;- cor(merged_data)\n\n# Find the row number corresponding to \"erate\"\nerate_row &lt;- which(rownames(correlation_matrix) == \"erate\")\n\n# Extract correlations between erate and other variables\ncorrelations_erate &lt;- correlation_matrix[erate_row, names(merged_data) != \"erate\"]\n\n# Print correlation values\nprint(correlations_erate)\n\n     exchange rate cpi_au cpi_us cashrate_au cashrate_us export_au export_us\n     import_au import_us realgdp_au realgdp_us unemployemtrate_au\n     unemployemtrate_us\n\n\n\nAugmented Dickey-Fuller test for log transformed variables except exchange rate and cash rate.\n\npar(mfcol = c(3, 2), mar=c(2,2,2,2))\nfor (i in 1:6){\nacf = acf(merged_data[,i], plot = FALSE)[1:20]\nplot(acf, main = \"\")\ntitle(main = paste(colnames(merged_data)[i]), line = 0.5)\n}\n\n\n\npar(mfrow = c(3, 2), mar=c(2,2,2,2))\nfor (i in 7:13){\nacf = acf(merged_data[,i], plot = FALSE)[1:20]\nplot(acf, main = \"\")\ntitle(main = paste(colnames(merged_data)[i]), line = 0.5)\n}\n\n\n\n\n\n\n\n\nadf_test &lt;- list()\nfor (i in 1:13) {\n  adf_result = adf.test(merged_data[,i], k = 4)\n  adf_test[[i]] &lt;- adf_result\n}\n\nprint(adf_test)\n\n[[1]]\n\n    Augmented Dickey-Fuller Test\n\ndata:  merged_data[, i]\nDickey-Fuller = -2.0604, Lag order = 4, p-value = 0.5507\nalternative hypothesis: stationary\n\n\n[[2]]\n\n    Augmented Dickey-Fuller Test\n\ndata:  merged_data[, i]\nDickey-Fuller = -1.9709, Lag order = 4, p-value = 0.5871\nalternative hypothesis: stationary\n\n\n[[3]]\n\n    Augmented Dickey-Fuller Test\n\ndata:  merged_data[, i]\nDickey-Fuller = -1.355, Lag order = 4, p-value = 0.8378\nalternative hypothesis: stationary\n\n\n[[4]]\n\n    Augmented Dickey-Fuller Test\n\ndata:  merged_data[, i]\nDickey-Fuller = -0.84089, Lag order = 4, p-value = 0.9536\nalternative hypothesis: stationary\n\n\n[[5]]\n\n    Augmented Dickey-Fuller Test\n\ndata:  merged_data[, i]\nDickey-Fuller = -2.9006, Lag order = 4, p-value = 0.2088\nalternative hypothesis: stationary\n\n\n[[6]]\n\n    Augmented Dickey-Fuller Test\n\ndata:  merged_data[, i]\nDickey-Fuller = -2.3971, Lag order = 4, p-value = 0.4137\nalternative hypothesis: stationary\n\n\n[[7]]\n\n    Augmented Dickey-Fuller Test\n\ndata:  merged_data[, i]\nDickey-Fuller = -2.8393, Lag order = 4, p-value = 0.2337\nalternative hypothesis: stationary\n\n\n[[8]]\n\n    Augmented Dickey-Fuller Test\n\ndata:  merged_data[, i]\nDickey-Fuller = -1.6656, Lag order = 4, p-value = 0.7113\nalternative hypothesis: stationary\n\n\n[[9]]\n\n    Augmented Dickey-Fuller Test\n\ndata:  merged_data[, i]\nDickey-Fuller = -3.132, Lag order = 4, p-value = 0.1147\nalternative hypothesis: stationary\n\n\n[[10]]\n\n    Augmented Dickey-Fuller Test\n\ndata:  merged_data[, i]\nDickey-Fuller = -3.0487, Lag order = 4, p-value = 0.1485\nalternative hypothesis: stationary\n\n\n[[11]]\n\n    Augmented Dickey-Fuller Test\n\ndata:  merged_data[, i]\nDickey-Fuller = -2.7396, Lag order = 4, p-value = 0.2743\nalternative hypothesis: stationary\n\n\n[[12]]\n\n    Augmented Dickey-Fuller Test\n\ndata:  merged_data[, i]\nDickey-Fuller = -2.1174, Lag order = 4, p-value = 0.5275\nalternative hypothesis: stationary\n\n\n[[13]]\n\n    Augmented Dickey-Fuller Test\n\ndata:  merged_data[, i]\nDickey-Fuller = -2.7746, Lag order = 4, p-value = 0.2601\nalternative hypothesis: stationary\n\n\n\nadf_table &lt;- data.frame(p_value = numeric(length(adf_test)))\n\nfor (i in 1:length(adf_test)) {adf_table[i, \"p_value\"] = round(adf_test[[i]]$p.value,3)\n}\n\nrownames(adf_table)&lt;- c(\"exchange rate\", \n                         \"cpi_au\",    \"cpi_us\", \n                         \"cashrate_au\",  \"cashrate_us\", \n                         \"export_au\", \"export_us\",\n                         \"import_au\",   \"import_us\",\n                         \"realgdp_au\", \"realgdp_us\",\n                         \"unemployemtrate_au\", \"unemployemtrate_us\")\n\ncolnames(adf_table)&lt;- c(\"P-value\")\nprint(adf_table)\n\n                   P-value\nexchange rate        0.551\ncpi_au               0.587\ncpi_us               0.838\ncashrate_au          0.954\ncashrate_us          0.209\nexport_au            0.414\nexport_us            0.234\nimport_au            0.711\nimport_us            0.115\nrealgdp_au           0.149\nrealgdp_us           0.274\nunemployemtrate_au   0.528\nunemployemtrate_us   0.260\n\n#clear that all &gt;0.05 and reject the null that is stationary\n\n\n#take the first difference\ndff_merged_data &lt;- na.omit(merged_data - lag(merged_data))\n\n\n# ADF test\ndff_adf_ &lt;- list()\nfor (i in 1:13) {\n  dff_adf_result = adf.test(dff_merged_data[,i], k = 4)\n  dff_adf_[[i]] &lt;- dff_adf_result\n}\n\nWarning in adf.test(dff_merged_data[, i], k = 4): p-value smaller than printed\np-value\n\nWarning in adf.test(dff_merged_data[, i], k = 4): p-value smaller than printed\np-value\n\n# View the ADF test results\ndff_adf_table &lt;- data.frame(p_value = numeric(length(dff_adf_)))\n\n# Fill in the data frame with the test results\nfor (i in 1:length(dff_adf_)) {\n  dff_adf_table[i, \"p_value\"] = round(dff_adf_[[i]]$p.value,3)\n\n}\nrownames(dff_adf_table)&lt;- c(\"exchange rate\",\n                         \"cpi_au\",    \"cpi_us\", \n                         \"cashrate_au\",  \"cashrate_us\", \n                         \"export_au\", \"export_us\",\n                         \"import_au\",   \"import_us\",\n                         \"realgdp_au\", \"realgdp_us\",\n                         \"unemployemtrate_au\", \"unemployemtrate_us\")\n\ncolnames(dff_adf_table)&lt;- c(\"P-value\")\nprint(dff_adf_table)\n\n                   P-value\nexchange rate        0.035\ncpi_au               0.442\ncpi_us               0.279\ncashrate_au          0.038\ncashrate_us          0.019\nexport_au            0.052\nexport_us            0.024\nimport_au            0.010\nimport_us            0.017\nrealgdp_au           0.034\nrealgdp_us           0.010\nunemployemtrate_au   0.023\nunemployemtrate_us   0.021\n\n\n\n#take the second difference \ndff_dff_data &lt;- subset(dff_merged_data, select = -c(realgdp_us))\n\n# Create a new dataset with the remaining variables\n\ndff_dff_merged_data &lt;- na.omit(dff_dff_data- lag(dff_dff_data)) \n\n\ndff_dff_adf_ &lt;- list()\nfor (i in 1:12) {\n  dff_dff_adf_result = adf.test(dff_dff_merged_data[,i], k = 4)\n  dff_dff_adf_[[i]] &lt;- dff_dff_adf_result\n}\n\nWarning in adf.test(dff_dff_merged_data[, i], k = 4): p-value smaller than\nprinted p-value\n\nWarning in adf.test(dff_dff_merged_data[, i], k = 4): p-value smaller than\nprinted p-value\n\nWarning in adf.test(dff_dff_merged_data[, i], k = 4): p-value smaller than\nprinted p-value\n\nWarning in adf.test(dff_dff_merged_data[, i], k = 4): p-value smaller than\nprinted p-value\n\nWarning in adf.test(dff_dff_merged_data[, i], k = 4): p-value smaller than\nprinted p-value\n\nWarning in adf.test(dff_dff_merged_data[, i], k = 4): p-value smaller than\nprinted p-value\n\nWarning in adf.test(dff_dff_merged_data[, i], k = 4): p-value smaller than\nprinted p-value\n\nWarning in adf.test(dff_dff_merged_data[, i], k = 4): p-value smaller than\nprinted p-value\n\nWarning in adf.test(dff_dff_merged_data[, i], k = 4): p-value smaller than\nprinted p-value\n\nWarning in adf.test(dff_dff_merged_data[, i], k = 4): p-value smaller than\nprinted p-value\n\nWarning in adf.test(dff_dff_merged_data[, i], k = 4): p-value smaller than\nprinted p-value\n\nWarning in adf.test(dff_dff_merged_data[, i], k = 4): p-value smaller than\nprinted p-value\n\n# View the ADF test results\ndff_dff_adf_table &lt;- data.frame(p_value = numeric(length(dff_dff_adf_)))\n\n# Fill in the data frame with the test results\nfor (i in 1:length(dff_dff_adf_)) {\n  dff_dff_adf_table[i, \"p_value\"] = round(dff_dff_adf_[[i]]$p.value,3)\n\n}\nrownames(dff_dff_adf_table)&lt;- c(\"exchange rate\", \n                         \"cpi_au\",    \"cpi_us\", \n                         \"cashrate_au\",  \"cashrate_us\", \n                         \"export_au\", \"export_us\",\n                         \"import_au\",   \"import_us\",\n                         \"realgdp_au\",\n                         \"unemployemtrate_au\", \"unemployemtrate_us\")\n\ncolnames(dff_dff_adf_table)&lt;- c(\"P-value\")\nprint(dff_dff_adf_table)\n\n                   P-value\nexchange rate         0.01\ncpi_au                0.01\ncpi_us                0.01\ncashrate_au           0.01\ncashrate_us           0.01\nexport_au             0.01\nexport_us             0.01\nimport_au             0.01\nimport_us             0.01\nrealgdp_au            0.01\nunemployemtrate_au    0.01\nunemployemtrate_us    0.01\n\n\n\\[\\begin{align}\nY =\\begin{pmatrix}\ny_{crateau_,1}&  y_{rgdpau_,1}&  y_{cpiau_,1}&  y_{unemrau_,1}&  y_{imporau_,1}&  y_{exporau_,1}&  y_{crateus_,1}&  y_{rgdpus_,1}&  y_{cpius_,1}&  y_{unemrus_,1}&  y_{imporus_,1}&  y_{exporus_,1}\\\\\ny_{crateau_,2}&  y_{rgdpau_,2}&  y_{cpiau_,2}&  y_{unemrau_,2}&  y_{imporau_,2}&  y_{exporau_,2}&  y_{crateus_,2}&  y_{rgdpus_,2}&  y_{cpius_,2}&  y_{unemrus_,2}&  y_{imporus_,2}&  y_{exporus_,2}\\\\ \\ \\vdots & \\vdots & \\vdots  & \\vdots & \\vdots & \\vdots& \\vdots& \\vdots& \\vdots& \\vdots& \\vdots & \\vdots\\\\\n\ny_{crateau_,T}&  y_{rgdpau_,T}&  y_{cpiau_,T}&  y_{unemrau_,T}&  y_{imporau_,T}&  y_{exporau_,T}&  y_{crateus_,T}&  y_{rgdpus_,T}&  y_{cpius_,T}&  y_{unemrus_,T}&  y_{imporus_,T}&  y_{exporus_,T}\n\\end{pmatrix}\n\\end{align}\\]"
  },
  {
    "objectID": "index.html#forecasting-with-basic-model-and-extended-model",
    "href": "index.html#forecasting-with-basic-model-and-extended-model",
    "title": "Exchange Rate Forecasting Using Bayesian VARs Model",
    "section": "Forecasting With Basic Model and Extended Model",
    "text": "Forecasting With Basic Model and Extended Model\n\n\n\n\n\n\n\n\n\n\n\nForecasting on extended model\n\n\n\n\n\n\n\n\n\n\nThe above presents the historical and forecasting data the AUD/USD exchange rate for basic and extended model.\nFor the point forecast, for basic model, the exchange rate shows several peaks and troughs, indicating the volatility in the exchange rate over the years. For the three years forecasting, it shows a slightly downward trend and reaching around 0.67 in 2026. And for extended model, it also shows a clear increasing trend and reaching around 0.751243 fo the following period. For conduct 90% confident interval for both models in which we can notice the extended model has an obvious narrow confident interval for both significant level, which means more informative, and this may be given by the nature of the Laplace distribution applied in the extended model in which the the fatter fail of Laplace distribution will capture more economic activities not covered by the underlying normal distribution, and resulting a more informative estimating of the parameters and then leading to a narrower confident interval as expected.\nRegard to the 3D with density intervals below for both model forecasting, we could notice that the for each different predictive density at specific horizons, with the back wall we have the one period ahead predictive density and with the front we have the 12 period ahead density which is 3 years. We could see the distribution becomes lower and more dispersed with the increases of the horizon, as the data is more informative about the nearest developments in the future. Hence, one period predictive density is highly concentrated relative to others with smaller variance and taller peak. Similarly, the interval become more wider and dispersed resulting a more uncertainty for the future period forecasting."
  },
  {
    "objectID": "index.html#the-extension-model-with-stochastic-volatility-heteroskedasticity",
    "href": "index.html#the-extension-model-with-stochastic-volatility-heteroskedasticity",
    "title": "Exchange Rate Forecasting Using Bayesian VARs Model",
    "section": "The Extension Model With Stochastic Volatility Heteroskedasticity",
    "text": "The Extension Model With Stochastic Volatility Heteroskedasticity\nWith stochastic volatility heteroskedasticity in our extended model, we have: \\(\\Omega=diag(e^{h_1}\\lambda_1,e^{h_2}\\lambda_2,...,e^{h_T}\\lambda_t)\\), represent as:\n\\[\\\\\\Omega = \\left(\n\\begin{array}{cccc}\ne^{h_1}\\lambda_1 & 0 & \\cdots & 0 \\\\\n0 & e^{h_2}\\lambda_2 & \\cdots & \\vdots \\\\\n0 & \\cdots & \\ddots & \\vdots \\\\\n0 & \\cdots & 0 &  e^{h_T}\\lambda_T\\\\\n\\end{array}\n\\right)\\] The likelihood function now change to:\n\\[\\begin{align}\nL(A,\\Sigma,\\Omega |Y,X) &\\propto \\det(\\Sigma)^{-\\frac{T}{2}} \\det(\\Omega)^{-\\frac{N}{2}} exp\\{-\\frac{1}{2} tr[\\Sigma^{-1} (Y-XA)' \\Omega^{-1} (Y-XA) ]\\}\\\\\n&=\\det(\\Sigma)^{-\\frac{T}{2}}\\prod^{T}_{t = 1} (e^{h_t}\\lambda_t)^{-\\frac{N}{2}} exp({-\\frac{1}{2}}\\sum^{T}_{t =1}{\\frac{1}{e^{h_t}\\lambda_t}} \\epsilon_t' \\Sigma^{-1}\\epsilon_t)\\\\\n&=\\det(\\Sigma)^{-\\frac{T}{2}}\\prod^{T}_{t = 1}( (e^{h_t}\\lambda_t)^{-\\frac{N}{2}} exp({-\\frac{1}{2}}{\\frac{1}{e^{h_t}\\lambda_t}} \\epsilon_t' \\Sigma^{-1}\\epsilon_t))\n\\end{align}\\]\nFor posterior distribution,\n\\[\\begin{align}\np(\\lambda_t|Y,X,A,\\Sigma) &\\propto L(A,\\Sigma,\\lambda_t|Y,X)p(\\lambda_t) \\\\\n\\\\\n&\\propto (e^{h_t}\\lambda_t)^{-\\frac{N}{2}} exp({-\\frac{1}{2}}{\\frac{1}{e^{h_t}\\lambda_t}} \\epsilon_t' \\Sigma^{-1}\\epsilon_t) \\\\\n&\\times \\frac{1}{\\alpha}exp\\{ -\\frac{1}{\\alpha}\\lambda_t \\}\\\\\n\n\n&= \\lambda_t^{-\\frac{N}{2}+1-1} exp\\{-\\frac{1}{2}[\\frac{e^{-h_t}\n\\epsilon_t'\\Sigma^{-1}\\epsilon_t} {\\lambda_t} +\\frac{2}{\\alpha}\\lambda_t]\\}\n\\end{align}\\]\n\\[\\begin{align}\n\\lambda_t|Y,A,\\Sigma &\\sim GIG(a,b,p) \\\\\n\\\\\na &=\\frac{2}{\\alpha} \\\\\nb &= \\epsilon_t' e^{-h_t}\\Sigma^{-1}\\epsilon_t \\\\\np &= -\\frac{N}{2}+1\n\\end{align}\\]\nGibbs Sampling Routine for SV and Laplace Distributed Errors\nInitialize \\(\\lambda^{(0)}\\) and \\(h_t^{(0)}\\).\nAt each iteration s:\n\nDraw \\(\\Sigma^{(s)}\\) from the \\(IW(\\bar{S},\\bar{\\nu})\\) distribution\nDraw \\(A^{(s)}\\) from the \\(MN(\\bar{A},\\Sigma^{(s)}, \\bar{V})\\) distribution\nDraw \\(\\lambda_t^{(s)}\\) from \\(GIG(a,b,p)\\)\nDraw \\(h^{(s)}\\) from the SV sampling routine described above"
  },
  {
    "objectID": "testtttt.html",
    "href": "testtttt.html",
    "title": "Untitled",
    "section": "",
    "text": "The second extension to the model is a further augmentation to the form of the errors in order to account for stochastic volatility. We can explicitly account for heteroskedasticity in the errors by applying a model specification in which the variance changes over time according to some stochastic process. This extension can be combined with the previous model including t-distributed errors to achieve an even more robust model for errors.\n\\[ \\begin{align}\nY &= XA + U \\\\\nU|\\lambda &\\sim MN(0, \\Sigma, \\lambda \\text{diag}(\\sigma^2)) \\\\\n\\lambda &\\sim IG2( s_{\\lambda}, \\nu_{\\lambda}) \\\\\n\\\\\n\\sigma^2 &= (\\exp(h_1), ..., exp(h_T)) \\\\\nh_T &- \\text{follows a stochastic volatility process} \\\\\n\\lambda &- \\text{the scale parameter for t errors}\n\\end{align}\\]\nIt is convenient for estimation to assume \\(h_t\\) follows a random walk process. That is,\n\\[\n\\begin{align}\nh_t &= h_{t-1} + \\sigma_v v_t \\\\\n\\\\\nv_t &\\sim \\mathcal{N}(0,1) \\\\\n\\sigma^2_v &- \\text{estimated parameter of the model}\n\\end{align}\n\\]\nEstimation of \\(h\\) is completed via its own Gibbs Sampling routine. The sampler is applied to a log-linearised form of the data which strips out the conditional mean in order to isolate the error term. The sampling routine involves drawing estimated parameters from a combination of Normal, IG2 as well the log Chi-Square distribution. The log Chi-Square distribution in this case is approximated by a mixture of ten normal distributions and sampled from using the inverse transform method. One pass of the sampler draws a sample of all of the estimated parameters, including \\(T\\times1\\) vector \\(h\\), the exponent of which forms \\(\\sigma^2\\).\nWith the overall model specified in this form, the likelihood function is as follows, with the \\(\\sigma^2\\) diagonal matrix entering in place of the previous identity matrix \\(I_T\\).\n\\[\n\\begin{align}\nL(A,\\Sigma,\\Lambda|Y,X) &\\propto \\det(\\Sigma)^{-\\frac{T}{2}} \\det(\\lambda \\times \\text{diag}(\\sigma^2))^{-\\frac{N}{2}} exp(-\\frac{1}{2} tr[\\Sigma^{-1} (Y-XA)' (\\lambda \\times \\text{diag}(\\sigma^2))^{-1} (Y-XA) ])\n\\end{align}\n\\]\nFollowing the same derivations as before, we compute the full conditionals for \\(A\\), \\(\\Sigma\\) and \\(\\lambda\\) as\n\\[\n\\begin{align}\np(A,\\Sigma|Y,X) &= MNIW(\\bar{A},\\bar{V},\\bar{S},\\bar{\\nu}) \\\\\n\\\\\n\\bar{V} &= (X'(\\lambda  \\text{diag}(\\sigma^2))^{-1}X + \\underline{V}^{-1})^{-1} \\\\\n\\bar{A} &= \\bar{V}(X'(\\lambda  \\text{diag}(\\sigma^2))^{-1}Y + \\underline{V}^{-1}\\underline{A}) \\\\\n\\bar{S} &= Y'(\\lambda  \\text{diag}(\\sigma^2))^{-1}Y + \\underline{A}'\\underline{V}^{-1}\\underline{A} + \\underline{S} - \\bar{A}'\\bar{V}^{-1}\\bar{A} \\\\\n\\bar{\\nu} &= T + \\underline{\\nu}\n\\\\\n\\\\\np(\\lambda|Y,A,\\Sigma) &= IG2(\\bar{s_{\\lambda}},\\bar{\\nu_{\\lambda}}) \\\\\n\\bar{s_{\\lambda}} &= tr[\\Sigma^{-1}(Y-XA)'\\text{diag}(\\sigma^2)^{-1}(Y-XA)] + \\underline{s_{\\lambda}} \\\\\n\\bar{\\nu_{\\lambda}} &= TN + \\underline{\\nu_{\\lambda}}\n\\end{align}\n\\] \\[\n\\begin{align}\np\\left(\\sigma^2_e\\right)&\\propto\\left(\\sigma^2_e\\right)^{-\\frac{\\underline{\\nu}+2}{2}} \\exp\\left\\{ -\\frac{1}{2}\\frac{\\underline{s}}{\\sigma^2_e} \\right\\}\n\\end{align}\n\\]\n\n\nInitialize \\(\\lambda^{(0)}\\) and \\(h_t^{(0)}\\).\nAt each iteration:\n\nDraw \\(\\Sigma^{(i)}\\) from the \\(IW(\\bar{S},\\bar{\\nu})\\) distribution\nDraw \\(A^{(i)}\\) from the \\(MN(\\bar{A},\\Sigma^{(i)}, \\bar{V})\\) distribution\nDraw \\(\\lambda^{(i)}\\) from \\(IG2(\\bar{s_{\\lambda}},\\bar{\\nu_{\\lambda}})\\)\nDraw \\(h^{(i)}\\) from the SV sampling routine described above"
  },
  {
    "objectID": "testtttt.html#model-extension-stochastic-volatility-with-t-distributed-errors",
    "href": "testtttt.html#model-extension-stochastic-volatility-with-t-distributed-errors",
    "title": "Untitled",
    "section": "",
    "text": "The second extension to the model is a further augmentation to the form of the errors in order to account for stochastic volatility. We can explicitly account for heteroskedasticity in the errors by applying a model specification in which the variance changes over time according to some stochastic process. This extension can be combined with the previous model including t-distributed errors to achieve an even more robust model for errors.\n\\[ \\begin{align}\nY &= XA + U \\\\\nU|\\lambda &\\sim MN(0, \\Sigma, \\lambda \\text{diag}(\\sigma^2)) \\\\\n\\lambda &\\sim IG2( s_{\\lambda}, \\nu_{\\lambda}) \\\\\n\\\\\n\\sigma^2 &= (\\exp(h_1), ..., exp(h_T)) \\\\\nh_T &- \\text{follows a stochastic volatility process} \\\\\n\\lambda &- \\text{the scale parameter for t errors}\n\\end{align}\\]\nIt is convenient for estimation to assume \\(h_t\\) follows a random walk process. That is,\n\\[\n\\begin{align}\nh_t &= h_{t-1} + \\sigma_v v_t \\\\\n\\\\\nv_t &\\sim \\mathcal{N}(0,1) \\\\\n\\sigma^2_v &- \\text{estimated parameter of the model}\n\\end{align}\n\\]\nEstimation of \\(h\\) is completed via its own Gibbs Sampling routine. The sampler is applied to a log-linearised form of the data which strips out the conditional mean in order to isolate the error term. The sampling routine involves drawing estimated parameters from a combination of Normal, IG2 as well the log Chi-Square distribution. The log Chi-Square distribution in this case is approximated by a mixture of ten normal distributions and sampled from using the inverse transform method. One pass of the sampler draws a sample of all of the estimated parameters, including \\(T\\times1\\) vector \\(h\\), the exponent of which forms \\(\\sigma^2\\).\nWith the overall model specified in this form, the likelihood function is as follows, with the \\(\\sigma^2\\) diagonal matrix entering in place of the previous identity matrix \\(I_T\\).\n\\[\n\\begin{align}\nL(A,\\Sigma,\\Lambda|Y,X) &\\propto \\det(\\Sigma)^{-\\frac{T}{2}} \\det(\\lambda \\times \\text{diag}(\\sigma^2))^{-\\frac{N}{2}} exp(-\\frac{1}{2} tr[\\Sigma^{-1} (Y-XA)' (\\lambda \\times \\text{diag}(\\sigma^2))^{-1} (Y-XA) ])\n\\end{align}\n\\]\nFollowing the same derivations as before, we compute the full conditionals for \\(A\\), \\(\\Sigma\\) and \\(\\lambda\\) as\n\\[\n\\begin{align}\np(A,\\Sigma|Y,X) &= MNIW(\\bar{A},\\bar{V},\\bar{S},\\bar{\\nu}) \\\\\n\\\\\n\\bar{V} &= (X'(\\lambda  \\text{diag}(\\sigma^2))^{-1}X + \\underline{V}^{-1})^{-1} \\\\\n\\bar{A} &= \\bar{V}(X'(\\lambda  \\text{diag}(\\sigma^2))^{-1}Y + \\underline{V}^{-1}\\underline{A}) \\\\\n\\bar{S} &= Y'(\\lambda  \\text{diag}(\\sigma^2))^{-1}Y + \\underline{A}'\\underline{V}^{-1}\\underline{A} + \\underline{S} - \\bar{A}'\\bar{V}^{-1}\\bar{A} \\\\\n\\bar{\\nu} &= T + \\underline{\\nu}\n\\\\\n\\\\\np(\\lambda|Y,A,\\Sigma) &= IG2(\\bar{s_{\\lambda}},\\bar{\\nu_{\\lambda}}) \\\\\n\\bar{s_{\\lambda}} &= tr[\\Sigma^{-1}(Y-XA)'\\text{diag}(\\sigma^2)^{-1}(Y-XA)] + \\underline{s_{\\lambda}} \\\\\n\\bar{\\nu_{\\lambda}} &= TN + \\underline{\\nu_{\\lambda}}\n\\end{align}\n\\] \\[\n\\begin{align}\np\\left(\\sigma^2_e\\right)&\\propto\\left(\\sigma^2_e\\right)^{-\\frac{\\underline{\\nu}+2}{2}} \\exp\\left\\{ -\\frac{1}{2}\\frac{\\underline{s}}{\\sigma^2_e} \\right\\}\n\\end{align}\n\\]\n\n\nInitialize \\(\\lambda^{(0)}\\) and \\(h_t^{(0)}\\).\nAt each iteration:\n\nDraw \\(\\Sigma^{(i)}\\) from the \\(IW(\\bar{S},\\bar{\\nu})\\) distribution\nDraw \\(A^{(i)}\\) from the \\(MN(\\bar{A},\\Sigma^{(i)}, \\bar{V})\\) distribution\nDraw \\(\\lambda^{(i)}\\) from \\(IG2(\\bar{s_{\\lambda}},\\bar{\\nu_{\\lambda}})\\)\nDraw \\(h^{(i)}\\) from the SV sampling routine described above"
  },
  {
    "objectID": "index.html#the-basic-model-with-stochastic-volatility-heteroskedasticity",
    "href": "index.html#the-basic-model-with-stochastic-volatility-heteroskedasticity",
    "title": "Exchange Rate Forecasting Using Bayesian VARs Model",
    "section": "The Basic Model With Stochastic Volatility Heteroskedasticity",
    "text": "The Basic Model With Stochastic Volatility Heteroskedasticity\nThe second modification enhances the model by capturing stochastic volatility in the error terms, which means the variance might vary over time according to a stochastic process. This adjustment allows the model to specifically account for heteroskedasticity, creating a more dynamic error structure. By integrating this feature with the earlier enhancement that introduced laplace errors, the model becomes significantly more robust in handling error variability.\nWith the stochastic volatility in innovation term, the basic model now with:\n\\[\\begin{align}\nY &= X A + U\n\\\\\nU |X &\\sim \\mathcal{MN}_{T\\times 13}(0,\\Sigma,\\mathrm{diag}(\\sigma_{T}^{2}))\n\\end{align} \\]\nWith \\(\\mathrm{diag}(\\sigma_{T}^{2})=diag(e^{h_1},e^{h_2},...,e^{h_T})\\), represent as:\nWhere \\(h_t\\) follows an AR(1) process:\n\\[\\begin{align}\nh_t &= h_{t-1} + \\sigma_v v_t \\\\\nv_t &\\sim \\mathcal{N}(0,1) \\\\\n\\sigma^2_v &\\sim IG2(\\bar{s},\\bar{\\nu})\n\\end{align}\\]\nThe basic heteroskedasticity model is still based on Natural-conjugate prior distribution, where the \\(A\\) follows a Matrix-variate Normal distribution and \\(\\Sigma\\) follows an Inverse Wishart distribution.\nWith the likelihood function now changes to :\n\\[\\begin{align}\nL\\left( {A},{\\Sigma}|Y,X \\right) &\\propto \\text{det}({\\Sigma})^{-\\frac{T}{2}}\\exp\\left\\{ -\\frac{1}{2}\\text{tr}\\left[ {\\Sigma}^{-1}(Y-X{A})'(Y-X{A}) \\right] \\right\\}\\\\\n&=\\text{det}({\\Sigma})^{-\\frac{T}{2}}\\\\\n&\\quad\\times\\exp\\left\\{ -\\frac{1}{2}\\text{tr}\\left[ {\\Sigma}^{-1}({A}-\\widehat{A})'X' \\ \\mathrm{diag}(\\sigma_{T}^{2})^{-1} \\ X({A}-\\widehat{A}) \\right] \\right\\}\\\\\n&\\quad\\times \\exp\\left\\{ -\\frac{1}{2}\\text{tr}\\left[ {\\Sigma}^{-1}(Y-X\\widehat{A})' \\ \\mathrm{diag}(\\sigma_{T}^{2})^{-1} \\ (Y-X\\widehat{A}) \\right] \\right\\}\n\\end{align} \\]\nFor posterior distribution,\n\\[\\begin{align}\np\\left( {A},{\\Sigma} |Y,X\\right)\n&\\propto  \\text{det}({\\Sigma})^{-\\frac{T}{2}}\\\\\n&\\quad\\times\\exp\\left\\{ -\\frac{1}{2}\\text{tr}\\left[ {\\Sigma}^{-1}({A}-\\widehat{A})'X' \\ \\mathrm{diag}(\\sigma_{T}^{2})^{-1} \\ X({A}-\\widehat{A}) \\right] \\right\\}\\\\\n&\\quad\\times \\exp\\left\\{ -\\frac{1}{2}\\text{tr}\\left[ {\\Sigma}^{-1}(Y-X\\widehat{A})' \\ \\mathrm{diag}(\\sigma_{T}^{2})^{-1} \\ (Y-X\\widehat{A}) \\right] \\right\\}\\\\\n& \\quad\\times\\text{det}({\\Sigma})^{-\\frac{N+K+\\underline{\\nu}+1}{2}}\\\\\n&\\quad\\times\\exp\\left\\{ -\\frac{1}{2}\\text{tr}\\left[ {\\Sigma}^{-1}({A}-\\underline{A})'\\underline{V}^{-1}({A}-\\underline{A}) \\right] \\right\\}\\\\\n&\\quad\\times \\exp\\left\\{ -\\frac{1}{2}\\text{tr}\\left[ {\\Sigma}^{-1}\\underline{S} \\right] \\right\\} \\\\\n\n\\end{align}\\]\nSimilarly, the kernel can be rearranged in the form of the Matrix-variate normal-inverse Wishart distribution.\n\\[\\begin{align}\n\\bar{V} &= (X'\\mathrm{diag}(\\sigma_{T}^{2})^{-1}X + \\underline{V}^{-1})^{-1}\\\\\n\\bar{A} &= \\bar{V}(X'\\mathrm{diag}(\\sigma_{T}^{2})^{-1}Y+\\underline{V}^{-1}\\underline{A})\\\\\n\\bar{\\nu} &= T+\\underline{\\nu}\\\\\n\\bar{S} &= Y'\\mathrm{diag}(\\sigma_{T}^{2})^{-1}Y+\\underline{A}'\\underline{V}^{-1}\\underline{A}-\\bar{A'}\\bar{V}^{-1}\\bar{A}+\\underline{S}\n\\end{align}\\]\n\nEstimation Outcomes on Basic Stochastic Volatility Model\n\nA.posterior.heter       = posterior.heter[[\"A\"]]\nSigma.posterior.heter   = posterior.heter[[\"Sigma\"]]\n\nhead(round(apply(A.posterior.heter, 1:2, mean),6))         # posterior draw A\n\n          [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]\n[1,]  0.002433  0.004684  0.005299 -0.000170  0.107246  0.021246  0.011413\n[2,]  0.999935 -0.000006  0.000010 -0.000476 -0.000135  0.000095  0.000061\n[3,]  0.000035  1.000014 -0.000012  0.001561  0.000573 -0.000122  0.000002\n[4,]  0.000043  0.000014  0.999987  0.001408  0.000445 -0.000125 -0.000002\n[5,]  0.000224 -0.000039  0.000022  0.987175 -0.002772 -0.000306  0.000317\n[6,] -0.000238  0.000001 -0.000145  0.001761  0.989091 -0.000693  0.000004\n          [,8]      [,9]     [,10]     [,11]     [,12]     [,13]\n[1,]  0.015815  0.017676  0.006747  0.006314 -0.112386 -0.033454\n[2,]  0.000100  0.000020  0.000002 -0.000003  0.000293 -0.000485\n[3,]  0.000085 -0.000043 -0.000006  0.000001  0.000794 -0.000339\n[4,]  0.000034 -0.000045 -0.000007  0.000006  0.000596 -0.000516\n[5,] -0.000421 -0.000092 -0.000092 -0.000039  0.007116  0.008091\n[6,] -0.000107 -0.000142  0.000069  0.000104  0.003440  0.004358\n\nhead(round(apply(Sigma.posterior.heter, 1:2, mean),6))     # posterior draw sigma\n\n         [,1]     [,2]     [,3]      [,4]      [,5]      [,6]     [,7]\n[1,]  5.1e-05 -1.0e-06  0.0e+00  0.000032 -0.000066 -0.000027  1.0e-06\n[2,] -1.0e-06  1.0e-06  0.0e+00  0.000017  0.000006  0.000000  0.0e+00\n[3,]  0.0e+00  0.0e+00  2.0e-06 -0.000010  0.000028  0.000001  0.0e+00\n[4,]  3.2e-05  1.7e-05 -1.0e-05  0.005334 -0.000706 -0.000147 -3.0e-06\n[5,] -6.6e-05  6.0e-06  2.8e-05 -0.000706  0.017044  0.000109 -4.5e-05\n[6,] -2.7e-05  0.0e+00  1.0e-06 -0.000147  0.000109  0.000126  8.0e-06\n          [,8]     [,9]    [,10]  [,11]     [,12]     [,13]\n[1,] -0.000054 -1.0e-06 -1.0e-06  0e+00 -0.000016  0.000043\n[2,]  0.000000  1.0e-06  0.0e+00  0e+00 -0.000008 -0.000006\n[3,] -0.000002  1.0e-06  0.0e+00  0e+00 -0.000011 -0.000002\n[4,] -0.000039  1.0e-05  3.0e-06 -5e-06 -0.000192 -0.000514\n[5,] -0.000143 -2.3e-05 -3.6e-05 -9e-06 -0.001070 -0.000842\n[6,]  0.000042  1.1e-05  2.0e-06  1e-06 -0.000168  0.000004\n\n\n\npar(mfrow=c(2,2), mar=c(4,4,2,2))\nplot.ts(A.posterior.heter[2,1,], xlab = \"Simulation times S\", ylab = \"AUD/USD exchange rate\", col = mcxs1)\nhist(A.posterior.heter[2,1,], xlab = \"AUD/USD exchange rate\", col = mcxs1, main = '')\n\nplot.ts(Sigma.posterior.heter[1,1,], xlab = \"Simulation times S\", ylab = \"AUD/USD exchange rate sigma\", col = mcxs2)\nhist(Sigma.posterior.heter[1,1,], xlab = \"AUD/USD exchange rate sigma\", col = mcxs2, main = '')\n\n\n\n\nWe can notice that compared to the above two models, the involve of the heteroskedasticity brings out outliers, which seems all around the zero, with the coeffcient now central round 1 and the sigma more central around zero. The change is obvious and significant, which will be demonstrated in the following forecasting plot."
  },
  {
    "objectID": "index.html#heter-plot",
    "href": "index.html#heter-plot",
    "title": "Exchange Rate Forecasting Using Bayesian VARs Model",
    "section": "heter plot",
    "text": "heter plot\n\n\n\n\n\nInteractive versions of the above 3D plots are provided below.\n\n\n\n\n\n\n\n\n\n\nThe 3D plots above allow us to access to alternative vantage points. We could notice that for the first few forecasting periods, the extended model has very sharp and concentrated densities around the point estimated, and it shows clearly heavy tails, which may increase the possibility of capturing extreme values that deviate significantly from the central forecast."
  },
  {
    "objectID": "index.html#forecasting-with-models",
    "href": "index.html#forecasting-with-models",
    "title": "Exchange Rate Forecasting Using Bayesian VARs Model",
    "section": "Forecasting With Models",
    "text": "Forecasting With Models\n\nForecasting With Basic Model\n\n\n\n\n\n\n\nForecasting on Extended Model\n\n\n\n\n\nThe above presents the historical and forecasting data the AUD/USD exchange rate for basic and extended model.\nFor the point forecast, for basic model, the exchange rate shows several peaks and troughs, indicating the volatility in the exchange rate over the years. For the three years forecasting, it shows a slightly downward trend and reaching around 0.67 in 2026. And for extended model, it shows a clear increasing trend and reaching around 0.75 in the end of the forecasting period. For conduct 90% confident interval for both models in which we can notice the extended model has an obvious narrow confident interval for both significant level, which means more informative, and this may be given by the nature of the Laplace distribution applied in the extended model in which the the fatter fail of Laplace distribution will capture more economic activities not covered by the underlying normal distribution, and resulting a more informative estimating of the parameters as it has a higher certainty from a more concentrated distribution and then leading to a narrower confident interval as expected.\n\n\n\n\n\nRegard to the 3D with density intervals above for both model forecasting, we could notice that the for each different predictive density at specific horizons, with the back wall we have the one period ahead predictive density and with the front we have the 12 period ahead density which is 3 years. We could see the distribution becomes lower and more dispersed with the increases of the horizon, as the data is more informative about the nearest developments in the future. Hence, one period predictive density is highly concentrated relative to others with smaller variance and taller peak. Similarly, the interval become more wider and dispersed resulting a more uncertainty for the future period forecasting.\n\n\nForecasting on Basic Model With Stochastic Volatility Heteroskedasticity\n\n\n\n\n\nBy involving the heteroskedasticity in the error term, the forecasting plot looks similar to the extended model, with the heteroskedasticity extension, it shows an increasing trend but reaching to the mean value more slowly and we could notice that the confident interval is also narrower compared to the basic model, indicating a more informative forecasting.\n\n\nInteractive 3D versions\nInteractive versions of the above 3D plots are provided below.\n\n\n\n\n\n\n\n\n\n\nThe 3D plots above allow us to access to alternative vantage points. We could notice that for the first few forecasting periods, the extended model has very sharp and concentrated densities around the point estimated, and it shows clearly heavy tails, which may increase the possibility of capturing extreme values that deviate significantly from the central forecast."
  }
]